<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Gesture Detection Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            min-height: calc(100vh - 40px);
        }

        .main-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .stats-panel, .history-panel, .categories-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
          
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .input-group h3 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .text-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            resize: vertical;
            min-height: 100px;
            margin-bottom: 10px;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .audio-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .controls-row {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .gesture-display {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .gesture-avatar {
            font-size: 100px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));
        }

        .gesture-text {
            font-size: 1.8em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .gesture-description {
            color: #666;
            font-size: 1.1em;
            max-width: 500px;
            margin-bottom: 20px;
        }

        .confidence-container {
            width: 100%;
            max-width: 400px;
        }

        .confidence-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .confidence-bar {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(45deg, #28a745, #20c997);
            border-radius: 6px;
            transition: width 0.8s ease;
            position: relative;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.2s ease;
        }

        .history-item:hover {
            background: #f8f9fa;
            cursor: pointer;
        }

        .history-emoji {
            font-size: 1.5em;
        }

        .history-text {
            flex: 1;
        }

        .history-time {
            font-size: 0.8em;
            color: #666;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .category-btn {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            font-size: 0.9em;
        }

        .category-btn:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .category-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .panel-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .clear-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            margin-left: auto;
        }

        .clear-btn:hover {
            background: #c82333;
        }

        .audio-visualization {
            width: 100%;
            height: 60px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .audio-bars {
            display: flex;
            gap: 3px;
            align-items: center;
        }

        .audio-bar {
            width: 4px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 2px;
            animation: audioWave 1s ease-in-out infinite;
        }

        .audio-bar:nth-child(1) { animation-delay: 0s; }
        .audio-bar:nth-child(2) { animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { animation-delay: 0.4s; }
        .audio-bar:nth-child(6) { animation-delay: 0.5s; }
        .audio-bar:nth-child(7) { animation-delay: 0.6s; }

        @keyframes audioWave {
            0%, 100% { height: 10px; }
            50% { height: 40px; }
        }

        .status {
            padding: 12px 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status.recording {
            background: linear-gradient(135deg, #ffe6e6, #ffcccb);
            color: #d63384;
            border: 1px solid #f5c6cb;
        }

        .status.processing {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status.success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) scale(1); }
            40% { transform: translateY(-10px) scale(1.05); }
            60% { transform: translateY(-5px) scale(1.02); }
        }

        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
                gap: 15px;
            }
           
            .input-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="main-panel">
            <div class="header">
                <h1>🤖 AI Gesture Detection Dashboard</h1>
                <p>Advanced text and speech to gesture conversion with real-time analytics</p>
            </div>

            <div class="input-section">
                <div class="input-group">
                    <h3>📝 Text Input</h3>
                    <textarea
                        id="textInput"
                        class="text-input"
                        placeholder="Type your message here... Try: 'Hello', 'I love you', 'Good job', 'Let's party', 'I'm confused'"
                    ></textarea>
                    <button id="processTextBtn" class="btn btn-primary">
                        ✨ Analyze Text
                    </button>
                </div>

                <div class="input-group">
                    <h3>🎤 Audio Input</h3>
                    <div class="audio-controls">
                        <div class="controls-row">
                            <button id="recordBtn" class="btn btn-primary">
                                🎤 Record
                            </button>
                            <button id="stopBtn" class="btn btn-secondary" disabled>
                                ⏹️ Stop
                            </button>
                        </div>
                        <button id="clearBtn" class="btn btn-danger">
                            🗑️ Clear All
                        </button>
                    </div>
                    <div id="audioVisualization" class="audio-visualization" style="display: none;">
                        <div class="audio-bars">
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                            <div class="audio-bar"></div>
                        </div>
                    </div>
                    <div id="statusDisplay"></div>
                    <div id="transcriptionDisplay" style="margin-top: 10px; padding: 10px; background: #e9ecef; border-radius: 8px; display: none;">
                        <strong>Transcription:</strong> <span id="transcriptionText"></span>
                    </div>
                    
                    <!-- Advanced Voice Control Section -->
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                        <h4 style="margin-bottom: 15px; color: #333;">🎤 Advanced Voice Control</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <button id="voiceControlBtn" class="btn btn-secondary" style="flex: 1;">
                                🎤 Activate Voice
                            </button>
                            <button id="wakeWordBtn" class="btn btn-secondary" style="flex: 1;">
                                🔧 Wake Word
                            </button>
                        </div>
                        <div id="voiceCommandsList" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; display: none;">
                            <h5 style="margin-bottom: 10px; color: #333;">Available Commands:</h5>
                            <div style="font-size: 0.9em; color: #666; line-height: 1.4;">
                                <div><strong>System:</strong></div>
                                <div>• "Jarvis, open dashboard"</div>
                                <div>• "Jarvis, clear all"</div>
                                <div>• "Jarvis, system status"</div>
                                <div>• "Jarvis, help"</div>
                                <div><strong>Gestures:</strong></div>
                                <div>• "Jarvis, show hello/love/thank you/goodbye"</div>
                                <div>• "Jarvis, start sequence" (then say gestures)</div>
                                <div>• "Jarvis, play sequence"</div>
                                <div><strong>Utility:</strong></div>
                                <div>• "Jarvis, what time is it"</div>
                                <div>• "Jarvis, list commands"</div>
                                <div>• "Jarvis, toggle voice feedback"</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 5px; font-size: 0.9em;">
                                <input type="checkbox" id="voiceFeedbackToggle" checked>
                                Voice Feedback
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; font-size: 0.9em;">
                                <input type="checkbox" id="autoResponseToggle" checked>
                                Auto Response
                            </label>
                        </div>
                        <button id="testJarvisBtn" class="btn btn-primary" style="width: 100%; margin-bottom: 10px;">
                            🧪 Test Jarvis
                        </button>
                    </div>

                    <!-- Text-to-Speech Section -->
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                        <h4 style="margin-bottom: 15px; color: #333;">🔊 Text to Speech</h4>
                        <div style="margin-bottom: 15px;">
                            <label for="ttsText" style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Text to Convert:</label>
                            <textarea id="ttsText" placeholder="Enter text to convert to speech..." style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; resize: vertical; min-height: 60px;"></textarea>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                            <div>
                                <label for="voiceSelect" style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Voice:</label>
                                <select id="voiceSelect" style="width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                                    <option value="">Loading voices...</option>
                                </select>
                            </div>
                            <div>
                                <label for="speedSelect" style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Speed:</label>
                                <select id="speedSelect" style="width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                                    <option value="0.5">Slow (0.5x)</option>
                                    <option value="0.75">Slow (0.75x)</option>
                                    <option value="1" selected>Normal (1x)</option>
                                    <option value="1.25">Fast (1.25x)</option>
                                    <option value="1.5">Fast (1.5x)</option>
                                    <option value="2">Very Fast (2x)</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button id="speakBtn" class="btn btn-primary" style="flex: 1;">
                                🔊 Speak
                            </button>
                            <button id="pauseBtn" class="btn btn-secondary" style="flex: 1;" disabled>
                                ⏸️ Pause
                            </button>
                            <button id="stopSpeakBtn" class="btn btn-danger" style="flex: 1;" disabled>
                                ⏹️ Stop
                            </button>
                        </div>
                        <div id="ttsStatus" style="margin-top: 10px; padding: 8px; border-radius: 6px; display: none;"></div>
                    </div>
                </div>
            </div>

            <div class="gesture-display" id="gestureDisplay">
                <div class="gesture-avatar">🤷‍♂️</div>
                <div class="gesture-text">Ready to detect gestures!</div>
                <div class="gesture-description">Enter text or record audio to see AI-powered gesture predictions</div>
                <div class="confidence-container">
                    <div class="confidence-label">
                        <span>Confidence Level</span>
                        <span id="confidencePercent">0%</span>
                    </div>
                    <div class="confidence-bar">
                        <div class="confidence-fill" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- AI Model Training Section -->
            <div class="ai-training-section" style="margin-top: 30px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 20px; padding: 30px;">
                <h2 style="text-align: center; margin-bottom: 25px; color: #333; font-size: 1.8em;">🤖 AI Model Training Center</h2>
                
                <!-- Training Controls -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                    <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0;">
                        <h3 style="margin-bottom: 15px; color: #333;">🎯 Training Mode</h3>
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <button id="startTrainingBtn" class="btn btn-primary" style="flex: 1;">🚀 Start Training</button>
                            <button id="stopTrainingBtn" class="btn btn-danger" style="flex: 1;" disabled>⏹️ Stop Training</button>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button id="saveModelBtn" class="btn btn-secondary" style="flex: 1;">💾 Save Model</button>
                            <button id="loadModelBtn" class="btn btn-secondary" style="flex: 1;">📂 Load Model</button>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0;">
                        <h3 style="margin-bottom: 15px; color: #333;">📊 Training Progress</h3>
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Epoch Progress</span>
                                <span id="epochProgress">0/100</span>
                            </div>
                            <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                                <div id="epochBar" style="height: 100%; background: linear-gradient(45deg, #667eea, #764ba2); width: 0%; transition: width 0.3s ease;"></div>
                            </div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Accuracy</span>
                                <span id="accuracyDisplay">0%</span>
                            </div>
                            <div style="width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden;">
                                <div id="accuracyBar" style="height: 100%; background: linear-gradient(45deg, #28a745, #20c997); width: 0%; transition: width 0.3s ease;"></div>
                            </div>
                        </div>
                        <div style="font-size: 0.9em; color: #666;">
                            <div>Loss: <span id="lossDisplay">0.000</span></div>
                            <div>Learning Rate: <span id="learningRateDisplay">0.001</span></div>
                        </div>
                    </div>
                </div>

                <!-- Sign Language Categories -->
                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #333;">🗣️ Sign Language Categories</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
                        <div class="sign-category" data-category="asl" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">🇺🇸</div>
                            <div style="font-weight: 600;">American Sign Language</div>
                            <div style="font-size: 0.8em; color: #666;">ASL</div>
                        </div>
                        <div class="sign-category" data-category="bsl" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">🇬🇧</div>
                            <div style="font-weight: 600;">British Sign Language</div>
                            <div style="font-size: 0.8em; color: #666;">BSL</div>
                        </div>
                        <div class="sign-category" data-category="isl" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">🇮🇳</div>
                            <div style="font-weight: 600;">Indian Sign Language</div>
                            <div style="font-size: 0.8em; color: #666;">ISL</div>
                        </div>
                        <div class="sign-category" data-category="jsl" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">🇯🇵</div>
                            <div style="font-weight: 600;">Japanese Sign Language</div>
                            <div style="font-size: 0.8em; color: #666;">JSL</div>
                        </div>
                        <div class="sign-category" data-category="ksl" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">🇰🇷</div>
                            <div style="font-weight: 600;">Korean Sign Language</div>
                            <div style="font-size: 0.8em; color: #666;">KSL</div>
                        </div>
                        <div class="sign-category" data-category="custom" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s ease;">
                            <div style="font-size: 1.2em; margin-bottom: 5px;">⚙️</div>
                            <div style="font-weight: 600;">Custom Signs</div>
                            <div style="font-size: 0.8em; color: #666;">Custom</div>
                        </div>
                    </div>
                </div>

                <!-- ASL Practice and Quiz Section -->
                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #333;">🤟 ASL Practice & Quiz</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="margin-bottom: 10px; color: #333;">🎯 Practice Mode</h4>
                            <p style="margin-bottom: 15px; color: #666; font-size: 0.9em;">Practice ASL signs with random words and get instant feedback.</p>
                            <button id="startPracticeBtn" class="btn btn-primary" style="width: 100%; margin-bottom: 10px;">🎯 Start Practice</button>
                            <button id="nextPracticeBtn" class="btn btn-secondary" style="width: 100%;" disabled>⏭️ Next Word</button>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 10px; color: #333;">📝 Quiz Mode</h4>
                            <p style="margin-bottom: 15px; color: #666; font-size: 0.9em;">Test your ASL knowledge with interactive quizzes.</p>
                            <button id="startQuizBtn" class="btn btn-primary" style="width: 100%; margin-bottom: 10px;">📝 Start Quiz</button>
                            <button id="nextQuizBtn" class="btn btn-secondary" style="width: 100%;" disabled>⏭️ Next Question</button>
                        </div>
                    </div>
                    <div id="practiceDisplay" style="margin-top: 20px; display: none;"></div>
                    <div id="quizDisplay" style="margin-top: 20px; display: none;"></div>
                </div>

                <!-- ASL Finger Spelling Section -->
                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #333;">🤟 ASL Finger Spelling</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <label for="fingerSpellInput" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Word to Spell:</label>
                            <input type="text" id="fingerSpellInput" placeholder="Enter a word to finger spell..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                            <button id="fingerSpellBtn" class="btn btn-primary" style="width: 100%; margin-top: 10px;">🤟 Finger Spell</button>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 10px; color: #333;">Quick Letters</h4>
                            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px;">
                                <button class="btn btn-secondary quick-letter" data-letter="a" style="font-size: 0.8em;">A</button>
                                <button class="btn btn-secondary quick-letter" data-letter="b" style="font-size: 0.8em;">B</button>
                                <button class="btn btn-secondary quick-letter" data-letter="c" style="font-size: 0.8em;">C</button>
                                <button class="btn btn-secondary quick-letter" data-letter="d" style="font-size: 0.8em;">D</button>
                                <button class="btn btn-secondary quick-letter" data-letter="e" style="font-size: 0.8em;">E</button>
                                <button class="btn btn-secondary quick-letter" data-letter="f" style="font-size: 0.8em;">F</button>
                                <button class="btn btn-secondary quick-letter" data-letter="g" style="font-size: 0.8em;">G</button>
                                <button class="btn btn-secondary quick-letter" data-letter="h" style="font-size: 0.8em;">H</button>
                                <button class="btn btn-secondary quick-letter" data-letter="i" style="font-size: 0.8em;">I</button>
                                <button class="btn btn-secondary quick-letter" data-letter="j" style="font-size: 0.8em;">J</button>
                                <button class="btn btn-secondary quick-letter" data-letter="k" style="font-size: 0.8em;">K</button>
                                <button class="btn btn-secondary quick-letter" data-letter="l" style="font-size: 0.8em;">L</button>
                                <button class="btn btn-secondary quick-letter" data-letter="m" style="font-size: 0.8em;">M</button>
                                <button class="btn btn-secondary quick-letter" data-letter="n" style="font-size: 0.8em;">N</button>
                                <button class="btn btn-secondary quick-letter" data-letter="o" style="font-size: 0.8em;">O</button>
                                <button class="btn btn-secondary quick-letter" data-letter="p" style="font-size: 0.8em;">P</button>
                                <button class="btn btn-secondary quick-letter" data-letter="q" style="font-size: 0.8em;">Q</button>
                                <button class="btn btn-secondary quick-letter" data-letter="r" style="font-size: 0.8em;">R</button>
                                <button class="btn btn-secondary quick-letter" data-letter="s" style="font-size: 0.8em;">S</button>
                                <button class="btn btn-secondary quick-letter" data-letter="t" style="font-size: 0.8em;">T</button>
                                <button class="btn btn-secondary quick-letter" data-letter="u" style="font-size: 0.8em;">U</button>
                                <button class="btn btn-secondary quick-letter" data-letter="v" style="font-size: 0.8em;">V</button>
                                <button class="btn btn-secondary quick-letter" data-letter="w" style="font-size: 0.8em;">W</button>
                                <button class="btn btn-secondary quick-letter" data-letter="x" style="font-size: 0.8em;">X</button>
                                <button class="btn btn-secondary quick-letter" data-letter="y" style="font-size: 0.8em;">Y</button>
                                <button class="btn btn-secondary quick-letter" data-letter="z" style="font-size: 0.8em;">Z</button>
                            </div>
                        </div>
                    </div>
                    <div id="fingerSpellDisplay" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; display: none;">
                        <h4 style="margin-bottom: 10px; color: #333;">Finger Spelling Result</h4>
                        <div id="fingerSpellResult"></div>
                    </div>
                </div>

                <!-- ChatGPT Integration -->
                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0; margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #333;">🧠 ChatGPT AI Assistant</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <label for="chatgptPrompt" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">AI Prompt:</label>
                            <textarea id="chatgptPrompt" placeholder="Ask ChatGPT to help with sign language training..." style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; resize: vertical; min-height: 80px;"></textarea>
                            <button id="askChatGPTBtn" class="btn btn-primary" style="width: 100%; margin-top: 10px;">🤖 Ask ChatGPT</button>
                        </div>
                        <div>
                            <label for="chatgptResponse" style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">AI Response:</label>
                            <div id="chatgptResponse" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; min-height: 80px; background: #f8f9fa; overflow-y: auto;">AI response will appear here...</div>
                            <button id="copyResponseBtn" class="btn btn-secondary" style="width: 100%; margin-top: 10px;">📋 Copy Response</button>
                        </div>
                    </div>
                </div>

                <!-- Training Data Management -->
                <div style="background: white; padding: 20px; border-radius: 15px; border: 2px solid #e0e0e0;">
                    <h3 style="margin-bottom: 15px; color: #333;">📚 Training Data Management</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="margin-bottom: 10px; color: #333;">📝 Add Training Data</h4>
                            <div style="margin-bottom: 10px;">
                                <label for="signWord" style="display: block; margin-bottom: 5px; font-weight: 600;">Sign Word:</label>
                                <input type="text" id="signWord" placeholder="Enter sign language word..." style="width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                            </div>
                            <div style="margin-bottom: 10px;">
                                <label for="signDescription" style="display: block; margin-bottom: 5px; font-weight: 600;">Description:</label>
                                <textarea id="signDescription" placeholder="Describe the sign gesture..." style="width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px; resize: vertical; min-height: 60px;"></textarea>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <label for="signCategory" style="display: block; margin-bottom: 5px; font-weight: 600;">Category:</label>
                                <select id="signCategory" style="width: 100%; padding: 8px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                                    <option value="greetings">Greetings</option>
                                    <option value="emotions">Emotions</option>
                                    <option value="actions">Actions</option>
                                    <option value="expressions">Expressions</option>
                                    <option value="social">Social</option>
                                    <option value="directions">Directions</option>
                                </select>
                            </div>
                            <button id="addTrainingDataBtn" class="btn btn-primary" style="width: 100%;">➕ Add to Training Set</button>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 10px; color: #333;">📊 Training Statistics</h4>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                <div style="margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Total Signs:</span>
                                    <span id="totalSigns" style="float: right;">0</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Training Accuracy:</span>
                                    <span id="trainingAccuracy" style="float: right;">0%</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Model Version:</span>
                                    <span id="modelVersion" style="float: right;">v1.0</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Last Updated:</span>
                                    <span id="lastUpdated" style="float: right;">Never</span>
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <button id="exportDataBtn" class="btn btn-secondary" style="width: 100%; margin-bottom: 8px;">📤 Export Training Data</button>
                                <button id="importDataBtn" class="btn btn-secondary" style="width: 100%;">📥 Import Training Data</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="stats-panel">
                <div class="panel-title">📊 Analytics</div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="totalGestures">0</span>
                        <span class="stat-label">Total Gestures</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="avgConfidence">0%</span>
                        <span class="stat-label">Avg Confidence</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="topCategory">-</span>
                        <span class="stat-label">Top Category</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="sessionsToday">1</span>
                        <span class="stat-label">Sessions Today</span>
                    </div>
                </div>
            </div>

            <div class="categories-panel">
                <div class="panel-title">🏷️ Categories</div>
                <div class="categories-grid">
                    <div class="category-btn active" data-category="all">All</div>
                    <div class="category-btn" data-category="greetings">Greetings</div>
                    <div class="category-btn" data-category="emotions">Emotions</div>
                    <div class="category-btn" data-category="actions">Actions</div>
                    <div class="category-btn" data-category="expressions">Expressions</div>
                    <div class="category-btn" data-category="reactions">Reactions</div>
                    <div class="category-btn" data-category="social">Social</div>
                    <div class="category-btn" data-category="directions">Directions</div>
                    <div class="category-btn" data-category="fingerspelling">Finger Spelling</div>
                    <div class="category-btn" data-category="family">Family</div>
                    <div class="category-btn" data-category="numbers">Numbers</div>
                    <div class="category-btn" data-category="colors">Colors</div>
                    <div class="category-btn" data-category="time">Time</div>
                    <div class="category-btn" data-category="food">Food</div>
                    <div class="category-btn" data-category="education">Education</div>
                    <div class="category-btn" data-category="work">Work</div>
                    <div class="category-btn" data-category="transportation">Transportation</div>
                    <div class="category-btn" data-category="weather">Weather</div>
                    <div class="category-btn" data-category="body">Body Parts</div>
                    <div class="category-btn" data-category="communication">Communication</div>
                    <div class="category-btn" data-category="questions">Questions</div>
                    <div class="category-btn" data-category="descriptions">Descriptions</div>
                    <div class="category-btn" data-category="locations">Locations</div>
                </div>
            </div>

            <div class="history-panel">
                <div class="panel-title">
                    📋 Recent History
                    <button class="clear-btn" id="clearHistoryBtn">Clear</button>
                </div>
                <div class="history-list" id="historyList">
                    <p style="text-align: center; color: #666; padding: 20px;">No gestures detected yet</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Gesture Database
        const gestureDatabase = {
            // Greetings & Introductions
            'hello': { emoji: '👋', name: 'Wave Hello', description: 'Friendly greeting gesture', confidence: 95, category: 'greetings' },
            'hi': { emoji: '👋', name: 'Wave Hello', description: 'Casual greeting', confidence: 90, category: 'greetings' },
            'hey': { emoji: '👋', name: 'Hey Wave', description: 'Informal greeting', confidence: 92, category: 'greetings' },
            'namaste': { emoji: '🙏', name: 'Namaste', description: 'Traditional Indian greeting', confidence: 98, category: 'greetings' },
            'good morning': { emoji: '🌅', name: 'Good Morning', description: 'Morning greeting', confidence: 94, category: 'greetings' },
            'good evening': { emoji: '🌆', name: 'Good Evening', description: 'Evening greeting', confidence: 94, category: 'greetings' },
            'good night': { emoji: '🌙', name: 'Good Night', description: 'Night farewell', confidence: 93, category: 'greetings' },
            'welcome': { emoji: '🤗', name: 'Welcome Hug', description: 'Welcoming gesture', confidence: 96, category: 'greetings' },
            'goodbye': { emoji: '👋', name: 'Wave Goodbye', description: 'Farewell gesture', confidence: 92, category: 'greetings' },
            'bye': { emoji: '👋', name: 'Wave Goodbye', description: 'Casual farewell', confidence: 88, category: 'greetings' },

            // Basic Emotions
            'happy': { emoji: '😊', name: 'Happy Smile', description: 'Expressing happiness and joy', confidence: 94, category: 'emotions' },
            'joy': { emoji: '😄', name: 'Joyful Expression', description: 'Pure joy and delight', confidence: 96, category: 'emotions' },
            'excited': { emoji: '🤩', name: 'Star-Struck', description: 'Excitement and amazement', confidence: 93, category: 'emotions' },
            'love': { emoji: '❤️', name: 'Heart Love', description: 'Expressing love and affection', confidence: 96, category: 'emotions' },
            'i love you': { emoji: '🥰', name: 'Love You', description: 'Expressing deep love', confidence: 98, category: 'emotions' },
            'sad': { emoji: '😢', name: 'Sad Expression', description: 'Showing sadness or disappointment', confidence: 91, category: 'emotions' },
            'angry': { emoji: '😠', name: 'Angry Expression', description: 'Displaying anger or frustration', confidence: 89, category: 'emotions' },
            'surprised': { emoji: '😲', name: 'Surprised', description: 'Shock or surprise', confidence: 92, category: 'emotions' },
            'confused': { emoji: '😕', name: 'Confused', description: 'Puzzled or uncertain', confidence: 88, category: 'emotions' },
            'worried': { emoji: '😟', name: 'Worried', description: 'Anxiety or concern', confidence: 90, category: 'emotions' },
            'scared': { emoji: '😨', name: 'Scared', description: 'Fear or fright', confidence: 93, category: 'emotions' },
            'tired': { emoji: '😴', name: 'Sleepy', description: 'Fatigue or sleepiness', confidence: 89, category: 'emotions' },

            // Positive Actions & Responses
            'thank you': { emoji: '🙏', name: 'Thank You', description: 'Gesture of gratitude', confidence: 97, category: 'actions' },
            'thanks': { emoji: '🙏', name: 'Thanks', description: 'Expressing gratitude', confidence: 94, category: 'actions' },
            'yes': { emoji: '👍', name: 'Thumbs Up', description: 'Positive agreement', confidence: 96, category: 'actions' },
            'no': { emoji: '👎', name: 'Thumbs Down', description: 'Negative response', confidence: 94, category: 'actions' },
            'ok': { emoji: '👌', name: 'OK Sign', description: 'Everything is fine', confidence: 95, category: 'actions' },
            'okay': { emoji: '👌', name: 'OK Sign', description: 'Agreement or approval', confidence: 93, category: 'actions' },
            'perfect': { emoji: '👌', name: 'Perfect Sign', description: 'Something is perfect', confidence: 97, category: 'actions' },
            'good job': { emoji: '👏', name: 'Applause', description: 'Praising good work', confidence: 96, category: 'actions' },
            'well done': { emoji: '👏', name: 'Clapping', description: 'Congratulating achievement', confidence: 94, category: 'actions' },
            'bravo': { emoji: '👏', name: 'Bravo Clap', description: 'Excellent performance praise', confidence: 98, category: 'actions' },

            // Social Expressions
            'please': { emoji: '🙏', name: 'Please Gesture', description: 'Making a polite request', confidence: 93, category: 'expressions' },
            'sorry': { emoji: '😔', name: 'Apologetic', description: 'Expressing regret or apology', confidence: 91, category: 'expressions' },
            'help': { emoji: '🙋‍♂️', name: 'Raise Hand', description: 'Seeking assistance', confidence: 94, category: 'expressions' },
            'congratulations': { emoji: '🎉', name: 'Celebration', description: 'Celebrating achievement', confidence: 96, category: 'expressions' },
            'good luck': { emoji: '🤞', name: 'Crossed Fingers', description: 'Wishing good fortune', confidence: 92, category: 'expressions' },

            // Party & Celebration
            'party': { emoji: '🎉', name: 'Party Time', description: 'Celebration and fun', confidence: 95, category: 'social' },
            'celebrate': { emoji: '🥳', name: 'Party Face', description: 'Celebrating with joy', confidence: 96, category: 'social' },
            'cheers': { emoji: '🥂', name: 'Cheers Toast', description: 'Toasting celebration', confidence: 94, category: 'social' },
            'dance': { emoji: '💃', name: 'Dancing', description: 'Dancing with joy', confidence: 93, category: 'social' },
            'music': { emoji: '🎵', name: 'Musical Note', description: 'Enjoying music', confidence: 90, category: 'social' },
            'fun': { emoji: '🎊', name: 'Confetti', description: 'Having fun', confidence: 92, category: 'social' },

            // Reactions & Responses
            'wow': { emoji: '🤩', name: 'Amazed', description: 'Impressed or amazed', confidence: 94, category: 'reactions' },
            'amazing': { emoji: '🤩', name: 'Star-Struck', description: 'Something is amazing', confidence: 96, category: 'reactions' },
            'awesome': { emoji: '😎', name: 'Cool Sunglasses', description: 'Something is awesome', confidence: 93, category: 'reactions' },
            'cool': { emoji: '😎', name: 'Cool', description: 'Something is cool', confidence: 91, category: 'reactions' },
            'funny': { emoji: '😂', name: 'Laughing', description: 'Something is funny', confidence: 95, category: 'reactions' },
            'hilarious': { emoji: '🤣', name: 'Rolling Laughter', description: 'Extremely funny', confidence: 97, category: 'reactions' }
        };

        // Global variables
        let history = [];
        let stats = {
            totalGestures: 0,
            totalConfidence: 0,
            categoryCount: {}
        };
        let isRecording = false;
        let mediaRecorder = null;
        let audioChunks = [];
        let recognition = null;
        
        // AI Model Training variables
        let isTraining = false;
        let trainingData = [];
        let modelVersion = 'v1.0';
        let currentEpoch = 0;
        let totalEpochs = 100;
        let currentAccuracy = 0;
        let currentLoss = 0;
        let learningRate = 0.001;
        let selectedSignLanguage = 'asl';
        let trainingInterval = null;
        
        // Enhanced ASL Database with Advanced Features
        const advancedASLDatabase = {
            // Finger Spelling Alphabet
            'a': { emoji: '🤟', name: 'ASL Letter A', description: 'Finger spelling: A - Fist with thumb on side', confidence: 98, category: 'fingerspelling' },
            'b': { emoji: '🤟', name: 'ASL Letter B', description: 'Finger spelling: B - Flat hand, fingers together', confidence: 98, category: 'fingerspelling' },
            'c': { emoji: '🤟', name: 'ASL Letter C', description: 'Finger spelling: C - Curved hand', confidence: 98, category: 'fingerspelling' },
            'd': { emoji: '🤟', name: 'ASL Letter D', description: 'Finger spelling: D - Index finger pointing up', confidence: 98, category: 'fingerspelling' },
            'e': { emoji: '🤟', name: 'ASL Letter E', description: 'Finger spelling: E - Fingers curled', confidence: 98, category: 'fingerspelling' },
            'f': { emoji: '🤟', name: 'ASL Letter F', description: 'Finger spelling: F - Index and thumb touching', confidence: 98, category: 'fingerspelling' },
            'g': { emoji: '🤟', name: 'ASL Letter G', description: 'Finger spelling: G - Index finger pointing', confidence: 98, category: 'fingerspelling' },
            'h': { emoji: '🤟', name: 'ASL Letter H', description: 'Finger spelling: H - Index and middle finger', confidence: 98, category: 'fingerspelling' },
            'i': { emoji: '🤟', name: 'ASL Letter I', description: 'Finger spelling: I - Pinky finger up', confidence: 98, category: 'fingerspelling' },
            'j': { emoji: '🤟', name: 'ASL Letter J', description: 'Finger spelling: J - Pinky finger with motion', confidence: 98, category: 'fingerspelling' },
            'k': { emoji: '🤟', name: 'ASL Letter K', description: 'Finger spelling: K - Index and middle finger spread', confidence: 98, category: 'fingerspelling' },
            'l': { emoji: '🤟', name: 'ASL Letter L', description: 'Finger spelling: L - Thumb and index finger', confidence: 98, category: 'fingerspelling' },
            'm': { emoji: '🤟', name: 'ASL Letter M', description: 'Finger spelling: M - Three fingers down', confidence: 98, category: 'fingerspelling' },
            'n': { emoji: '🤟', name: 'ASL Letter N', description: 'Finger spelling: N - Two fingers down', confidence: 98, category: 'fingerspelling' },
            'o': { emoji: '🤟', name: 'ASL Letter O', description: 'Finger spelling: O - Fingers curled in circle', confidence: 98, category: 'fingerspelling' },
            'p': { emoji: '🤟', name: 'ASL Letter P', description: 'Finger spelling: P - Index finger pointing down', confidence: 98, category: 'fingerspelling' },
            'q': { emoji: '🤟', name: 'ASL Letter Q', description: 'Finger spelling: Q - Index finger pointing down', confidence: 98, category: 'fingerspelling' },
            'r': { emoji: '🤟', name: 'ASL Letter R', description: 'Finger spelling: R - Index and middle finger crossed', confidence: 98, category: 'fingerspelling' },
            's': { emoji: '🤟', name: 'ASL Letter S', description: 'Finger spelling: S - Fist', confidence: 98, category: 'fingerspelling' },
            't': { emoji: '🤟', name: 'ASL Letter T', description: 'Finger spelling: T - Index finger pointing up', confidence: 98, category: 'fingerspelling' },
            'u': { emoji: '🤟', name: 'ASL Letter U', description: 'Finger spelling: U - Index and middle finger up', confidence: 98, category: 'fingerspelling' },
            'v': { emoji: '🤟', name: 'ASL Letter V', description: 'Finger spelling: V - Index and middle finger spread', confidence: 98, category: 'fingerspelling' },
            'w': { emoji: '🤟', name: 'ASL Letter W', description: 'Finger spelling: W - Three fingers up', confidence: 98, category: 'fingerspelling' },
            'x': { emoji: '🤟', name: 'ASL Letter X', description: 'Finger spelling: X - Index finger bent', confidence: 98, category: 'fingerspelling' },
            'y': { emoji: '🤟', name: 'ASL Letter Y', description: 'Finger spelling: Y - Thumb and pinky up', confidence: 98, category: 'fingerspelling' },
            'z': { emoji: '🤟', name: 'ASL Letter Z', description: 'Finger spelling: Z - Index finger with motion', confidence: 98, category: 'fingerspelling' },

            // Advanced ASL Signs
            'family': { emoji: '👨‍👩‍👧‍👦', name: 'ASL Family', description: 'ASL sign for family - F handshape moving in circle', confidence: 95, category: 'family' },
            'mother': { emoji: '👩', name: 'ASL Mother', description: 'ASL sign for mother - Thumb on chin', confidence: 96, category: 'family' },
            'father': { emoji: '👨', name: 'ASL Father', description: 'ASL sign for father - Thumb on forehead', confidence: 96, category: 'family' },
            'sister': { emoji: '👧', name: 'ASL Sister', description: 'ASL sign for sister - Index finger on chin', confidence: 94, category: 'family' },
            'brother': { emoji: '👦', name: 'ASL Brother', description: 'ASL sign for brother - Index finger on forehead', confidence: 94, category: 'family' },
            'baby': { emoji: '👶', name: 'ASL Baby', description: 'ASL sign for baby - Cradling motion', confidence: 93, category: 'family' },
            'child': { emoji: '🧒', name: 'ASL Child', description: 'ASL sign for child - Patting motion', confidence: 92, category: 'family' },

            // Numbers
            'one': { emoji: '1️⃣', name: 'ASL Number 1', description: 'ASL sign for number 1 - Index finger up', confidence: 98, category: 'numbers' },
            'two': { emoji: '2️⃣', name: 'ASL Number 2', description: 'ASL sign for number 2 - Index and middle finger', confidence: 98, category: 'numbers' },
            'three': { emoji: '3️⃣', name: 'ASL Number 3', description: 'ASL sign for number 3 - Three fingers up', confidence: 98, category: 'numbers' },
            'four': { emoji: '4️⃣', name: 'ASL Number 4', description: 'ASL sign for number 4 - Four fingers up', confidence: 98, category: 'numbers' },
            'five': { emoji: '5️⃣', name: 'ASL Number 5', description: 'ASL sign for number 5 - All fingers up', confidence: 98, category: 'numbers' },
            'six': { emoji: '6️⃣', name: 'ASL Number 6', description: 'ASL sign for number 6 - Thumb and pinky up', confidence: 98, category: 'numbers' },
            'seven': { emoji: '7️⃣', name: 'ASL Number 7', description: 'ASL sign for number 7 - Thumb and index finger', confidence: 98, category: 'numbers' },
            'eight': { emoji: '8️⃣', name: 'ASL Number 8', description: 'ASL sign for number 8 - Thumb and three fingers', confidence: 98, category: 'numbers' },
            'nine': { emoji: '9️⃣', name: 'ASL Number 9', description: 'ASL sign for number 9 - Thumb and four fingers', confidence: 98, category: 'numbers' },
            'ten': { emoji: '🔟', name: 'ASL Number 10', description: 'ASL sign for number 10 - Thumb up', confidence: 98, category: 'numbers' },

            // Colors
            'red': { emoji: '🔴', name: 'ASL Red', description: 'ASL sign for red - Index finger on chin', confidence: 94, category: 'colors' },
            'blue': { emoji: '🔵', name: 'ASL Blue', description: 'ASL sign for blue - B handshape moving', confidence: 94, category: 'colors' },
            'green': { emoji: '🟢', name: 'ASL Green', description: 'ASL sign for green - G handshape moving', confidence: 94, category: 'colors' },
            'yellow': { emoji: '🟡', name: 'ASL Yellow', description: 'ASL sign for yellow - Y handshape moving', confidence: 94, category: 'colors' },
            'white': { emoji: '⚪', name: 'ASL White', description: 'ASL sign for white - W handshape on chest', confidence: 94, category: 'colors' },
            'black': { emoji: '⚫', name: 'ASL Black', description: 'ASL sign for black - Index finger on forehead', confidence: 94, category: 'colors' },

            // Advanced Emotions
            'proud': { emoji: '😌', name: 'ASL Proud', description: 'ASL sign for proud - P handshape on chest', confidence: 92, category: 'emotions' },
            'jealous': { emoji: '😒', name: 'ASL Jealous', description: 'ASL sign for jealous - J handshape on chest', confidence: 90, category: 'emotions' },
            'embarrassed': { emoji: '😳', name: 'ASL Embarrassed', description: 'ASL sign for embarrassed - E handshape on cheeks', confidence: 91, category: 'emotions' },
            'nervous': { emoji: '😰', name: 'ASL Nervous', description: 'ASL sign for nervous - N handshape shaking', confidence: 89, category: 'emotions' },
            'excited': { emoji: '🤩', name: 'ASL Excited', description: 'ASL sign for excited - E handshape moving', confidence: 93, category: 'emotions' },

            // Time and Calendar
            'today': { emoji: '📅', name: 'ASL Today', description: 'ASL sign for today - Y handshape moving down', confidence: 95, category: 'time' },
            'yesterday': { emoji: '📅', name: 'ASL Yesterday', description: 'ASL sign for yesterday - Y handshape moving back', confidence: 95, category: 'time' },
            'tomorrow': { emoji: '📅', name: 'ASL Tomorrow', description: 'ASL sign for tomorrow - Y handshape moving forward', confidence: 95, category: 'time' },
            'morning': { emoji: '🌅', name: 'ASL Morning', description: 'ASL sign for morning - M handshape on arm', confidence: 94, category: 'time' },
            'afternoon': { emoji: '🌞', name: 'ASL Afternoon', description: 'ASL sign for afternoon - A handshape on arm', confidence: 94, category: 'time' },
            'night': { emoji: '🌙', name: 'ASL Night', description: 'ASL sign for night - N handshape on arm', confidence: 94, category: 'time' },
            'week': { emoji: '📅', name: 'ASL Week', description: 'ASL sign for week - W handshape moving', confidence: 93, category: 'time' },
            'month': { emoji: '📅', name: 'ASL Month', description: 'ASL sign for month - M handshape moving', confidence: 93, category: 'time' },
            'year': { emoji: '📅', name: 'ASL Year', description: 'ASL sign for year - Y handshape moving', confidence: 93, category: 'time' },

            // Food and Drinks
            'eat': { emoji: '🍽️', name: 'ASL Eat', description: 'ASL sign for eat - Hand to mouth', confidence: 96, category: 'food' },
            'drink': { emoji: '🥤', name: 'ASL Drink', description: 'ASL sign for drink - C handshape to mouth', confidence: 96, category: 'food' },
            'hungry': { emoji: '🍽️', name: 'ASL Hungry', description: 'ASL sign for hungry - Hand on stomach', confidence: 94, category: 'food' },
            'thirsty': { emoji: '🥤', name: 'ASL Thirsty', description: 'ASL sign for thirsty - Index finger on throat', confidence: 94, category: 'food' },
            'food': { emoji: '🍕', name: 'ASL Food', description: 'ASL sign for food - F handshape to mouth', confidence: 95, category: 'food' },
            'water': { emoji: '💧', name: 'ASL Water', description: 'ASL sign for water - W handshape to mouth', confidence: 95, category: 'food' },
            'bread': { emoji: '🍞', name: 'ASL Bread', description: 'ASL sign for bread - B handshape cutting', confidence: 93, category: 'food' },
            'milk': { emoji: '🥛', name: 'ASL Milk', description: 'ASL sign for milk - Squeezing motion', confidence: 93, category: 'food' },

            // School and Education
            'learn': { emoji: '📚', name: 'ASL Learn', description: 'ASL sign for learn - L handshape on forehead', confidence: 95, category: 'education' },
            'teach': { emoji: '👨‍🏫', name: 'ASL Teach', description: 'ASL sign for teach - T handshape moving', confidence: 95, category: 'education' },
            'school': { emoji: '🏫', name: 'ASL School', description: 'ASL sign for school - Clapping motion', confidence: 96, category: 'education' },
            'student': { emoji: '👨‍🎓', name: 'ASL Student', description: 'ASL sign for student - S handshape on chest', confidence: 94, category: 'education' },
            'teacher': { emoji: '👩‍🏫', name: 'ASL Teacher', description: 'ASL sign for teacher - T handshape on chest', confidence: 94, category: 'education' },
            'book': { emoji: '📖', name: 'ASL Book', description: 'ASL sign for book - B handshape opening', confidence: 95, category: 'education' },
            'read': { emoji: '📖', name: 'ASL Read', description: 'ASL sign for read - R handshape moving', confidence: 95, category: 'education' },
            'write': { emoji: '✍️', name: 'ASL Write', description: 'ASL sign for write - W handshape moving', confidence: 95, category: 'education' },

            // Work and Jobs
            'work': { emoji: '💼', name: 'ASL Work', description: 'ASL sign for work - W handshape on other hand', confidence: 95, category: 'work' },
            'job': { emoji: '💼', name: 'ASL Job', description: 'ASL sign for job - J handshape on chest', confidence: 94, category: 'work' },
            'money': { emoji: '💰', name: 'ASL Money', description: 'ASL sign for money - M handshape rubbing', confidence: 95, category: 'work' },
            'buy': { emoji: '🛒', name: 'ASL Buy', description: 'ASL sign for buy - B handshape moving', confidence: 94, category: 'work' },
            'sell': { emoji: '🏪', name: 'ASL Sell', description: 'ASL sign for sell - S handshape moving', confidence: 94, category: 'work' },

            // Transportation
            'car': { emoji: '🚗', name: 'ASL Car', description: 'ASL sign for car - C handshape steering', confidence: 95, category: 'transportation' },
            'bus': { emoji: '🚌', name: 'ASL Bus', description: 'ASL sign for bus - B handshape moving', confidence: 94, category: 'transportation' },
            'train': { emoji: '🚂', name: 'ASL Train', description: 'ASL sign for train - T handshape moving', confidence: 94, category: 'transportation' },
            'airplane': { emoji: '✈️', name: 'ASL Airplane', description: 'ASL sign for airplane - A handshape flying', confidence: 95, category: 'transportation' },
            'drive': { emoji: '🚗', name: 'ASL Drive', description: 'ASL sign for drive - D handshape steering', confidence: 94, category: 'transportation' },
            'walk': { emoji: '🚶', name: 'ASL Walk', description: 'ASL sign for walk - W handshape moving', confidence: 95, category: 'transportation' },
            'run': { emoji: '🏃', name: 'ASL Run', description: 'ASL sign for run - R handshape moving', confidence: 95, category: 'transportation' },

            // Weather
            'sun': { emoji: '☀️', name: 'ASL Sun', description: 'ASL sign for sun - S handshape in circle', confidence: 94, category: 'weather' },
            'rain': { emoji: '🌧️', name: 'ASL Rain', description: 'ASL sign for rain - R handshape falling', confidence: 94, category: 'weather' },
            'snow': { emoji: '❄️', name: 'ASL Snow', description: 'ASL sign for snow - S handshape falling', confidence: 94, category: 'weather' },
            'hot': { emoji: '🔥', name: 'ASL Hot', description: 'ASL sign for hot - H handshape on forehead', confidence: 94, category: 'weather' },
            'cold': { emoji: '❄️', name: 'ASL Cold', description: 'ASL sign for cold - C handshape shaking', confidence: 94, category: 'weather' },
            'warm': { emoji: '🌡️', name: 'ASL Warm', description: 'ASL sign for warm - W handshape on chest', confidence: 93, category: 'weather' },

            // Body Parts
            'head': { emoji: '👤', name: 'ASL Head', description: 'ASL sign for head - H handshape on head', confidence: 96, category: 'body' },
            'eye': { emoji: '👁️', name: 'ASL Eye', description: 'ASL sign for eye - E handshape on eye', confidence: 95, category: 'body' },
            'ear': { emoji: '👂', name: 'ASL Ear', description: 'ASL sign for ear - E handshape on ear', confidence: 95, category: 'body' },
            'nose': { emoji: '👃', name: 'ASL Nose', description: 'ASL sign for nose - N handshape on nose', confidence: 95, category: 'body' },
            'mouth': { emoji: '👄', name: 'ASL Mouth', description: 'ASL sign for mouth - M handshape on mouth', confidence: 95, category: 'body' },
            'hand': { emoji: '✋', name: 'ASL Hand', description: 'ASL sign for hand - H handshape on hand', confidence: 96, category: 'body' },
            'foot': { emoji: '🦶', name: 'ASL Foot', description: 'ASL sign for foot - F handshape on foot', confidence: 95, category: 'body' },
            'arm': { emoji: '💪', name: 'ASL Arm', description: 'ASL sign for arm - A handshape on arm', confidence: 95, category: 'body' },
            'leg': { emoji: '🦵', name: 'ASL Leg', description: 'ASL sign for leg - L handshape on leg', confidence: 95, category: 'body' },

            // Advanced Communication
            'understand': { emoji: '🧠', name: 'ASL Understand', description: 'ASL sign for understand - Index finger on forehead', confidence: 95, category: 'communication' },
            'know': { emoji: '🧠', name: 'ASL Know', description: 'ASL sign for know - K handshape on forehead', confidence: 95, category: 'communication' },
            'think': { emoji: '🤔', name: 'ASL Think', description: 'ASL sign for think - Index finger on temple', confidence: 94, category: 'communication' },
            'remember': { emoji: '🧠', name: 'ASL Remember', description: 'ASL sign for remember - R handshape on forehead', confidence: 94, category: 'communication' },
            'forget': { emoji: '🧠', name: 'ASL Forget', description: 'ASL sign for forget - F handshape on forehead', confidence: 94, category: 'communication' },
            'believe': { emoji: '🤝', name: 'ASL Believe', description: 'ASL sign for believe - B handshape on chest', confidence: 93, category: 'communication' },
            'doubt': { emoji: '🤔', name: 'ASL Doubt', description: 'ASL sign for doubt - D handshape on forehead', confidence: 93, category: 'communication' },

            // Advanced Actions
            'create': { emoji: '✨', name: 'ASL Create', description: 'ASL sign for create - C handshape moving', confidence: 93, category: 'actions' },
            'build': { emoji: '🏗️', name: 'ASL Build', description: 'ASL sign for build - B handshape stacking', confidence: 93, category: 'actions' },
            'fix': { emoji: '🔧', name: 'ASL Fix', description: 'ASL sign for fix - F handshape twisting', confidence: 93, category: 'actions' },
            'break': { emoji: '💥', name: 'ASL Break', description: 'ASL sign for break - B handshape snapping', confidence: 93, category: 'actions' },
            'open': { emoji: '🚪', name: 'ASL Open', description: 'ASL sign for open - O handshape opening', confidence: 95, category: 'actions' },
            'close': { emoji: '🚪', name: 'ASL Close', description: 'ASL sign for close - C handshape closing', confidence: 95, category: 'actions' },
            'start': { emoji: '▶️', name: 'ASL Start', description: 'ASL sign for start - S handshape moving', confidence: 94, category: 'actions' },
            'stop': { emoji: '⏹️', name: 'ASL Stop', description: 'ASL sign for stop - S handshape blocking', confidence: 94, category: 'actions' },
            'finish': { emoji: '✅', name: 'ASL Finish', description: 'ASL sign for finish - F handshape moving', confidence: 94, category: 'actions' },
            'continue': { emoji: '➡️', name: 'ASL Continue', description: 'ASL sign for continue - C handshape moving', confidence: 93, category: 'actions' },

            // Advanced Social
            'friend': { emoji: '👥', name: 'ASL Friend', description: 'ASL sign for friend - F handshape on chest', confidence: 95, category: 'social' },
            'enemy': { emoji: '👤', name: 'ASL Enemy', description: 'ASL sign for enemy - E handshape pointing', confidence: 93, category: 'social' },
            'neighbor': { emoji: '🏠', name: 'ASL Neighbor', description: 'ASL sign for neighbor - N handshape moving', confidence: 92, category: 'social' },
            'stranger': { emoji: '👤', name: 'ASL Stranger', description: 'ASL sign for stranger - S handshape pointing', confidence: 92, category: 'social' },
            'team': { emoji: '👥', name: 'ASL Team', description: 'ASL sign for team - T handshape on chest', confidence: 93, category: 'social' },
            'group': { emoji: '👥', name: 'ASL Group', description: 'ASL sign for group - G handshape moving', confidence: 93, category: 'social' },
            'alone': { emoji: '👤', name: 'ASL Alone', description: 'ASL sign for alone - A handshape on chest', confidence: 92, category: 'social' },
            'together': { emoji: '👥', name: 'ASL Together', description: 'ASL sign for together - T handshape joining', confidence: 93, category: 'social' },

            // Advanced Questions
            'what': { emoji: '❓', name: 'ASL What', description: 'ASL sign for what - W handshape moving', confidence: 96, category: 'questions' },
            'where': { emoji: '📍', name: 'ASL Where', description: 'ASL sign for where - W handshape pointing', confidence: 96, category: 'questions' },
            'when': { emoji: '⏰', name: 'ASL When', description: 'ASL sign for when - W handshape on wrist', confidence: 96, category: 'questions' },
            'why': { emoji: '🤔', name: 'ASL Why', description: 'ASL sign for why - W handshape on forehead', confidence: 96, category: 'questions' },
            'how': { emoji: '❓', name: 'ASL How', description: 'ASL sign for how - H handshape moving', confidence: 96, category: 'questions' },
            'who': { emoji: '👤', name: 'ASL Who', description: 'ASL sign for who - W handshape pointing', confidence: 96, category: 'questions' },
            'which': { emoji: '❓', name: 'ASL Which', description: 'ASL sign for which - W handshape moving', confidence: 95, category: 'questions' },

            // Advanced Descriptions
            'big': { emoji: '📏', name: 'ASL Big', description: 'ASL sign for big - B handshape expanding', confidence: 95, category: 'descriptions' },
            'small': { emoji: '📏', name: 'ASL Small', description: 'ASL sign for small - S handshape contracting', confidence: 95, category: 'descriptions' },
            'tall': { emoji: '📏', name: 'ASL Tall', description: 'ASL sign for tall - T handshape up', confidence: 95, category: 'descriptions' },
            'short': { emoji: '📏', name: 'ASL Short', description: 'ASL sign for short - S handshape down', confidence: 95, category: 'descriptions' },
            'long': { emoji: '📏', name: 'ASL Long', description: 'ASL sign for long - L handshape extending', confidence: 95, category: 'descriptions' },
            'wide': { emoji: '📏', name: 'ASL Wide', description: 'ASL sign for wide - W handshape spreading', confidence: 94, category: 'descriptions' },
            'narrow': { emoji: '📏', name: 'ASL Narrow', description: 'ASL sign for narrow - N handshape contracting', confidence: 94, category: 'descriptions' },
            'heavy': { emoji: '⚖️', name: 'ASL Heavy', description: 'ASL sign for heavy - H handshape dropping', confidence: 94, category: 'descriptions' },
            'light': { emoji: '💡', name: 'ASL Light', description: 'ASL sign for light - L handshape floating', confidence: 94, category: 'descriptions' },
            'strong': { emoji: '💪', name: 'ASL Strong', description: 'ASL sign for strong - S handshape flexing', confidence: 94, category: 'descriptions' },
            'weak': { emoji: '💪', name: 'ASL Weak', description: 'ASL sign for weak - W handshape drooping', confidence: 94, category: 'descriptions' },

            // Advanced Locations
            'here': { emoji: '📍', name: 'ASL Here', description: 'ASL sign for here - H handshape pointing down', confidence: 96, category: 'locations' },
            'there': { emoji: '📍', name: 'ASL There', description: 'ASL sign for there - T handshape pointing', confidence: 96, category: 'locations' },
            'inside': { emoji: '🏠', name: 'ASL Inside', description: 'ASL sign for inside - I handshape entering', confidence: 95, category: 'locations' },
            'outside': { emoji: '🌳', name: 'ASL Outside', description: 'ASL sign for outside - O handshape exiting', confidence: 95, category: 'locations' },
            'upstairs': { emoji: '🏠', name: 'ASL Upstairs', description: 'ASL sign for upstairs - U handshape up', confidence: 94, category: 'locations' },
            'downstairs': { emoji: '🏠', name: 'ASL Downstairs', description: 'ASL sign for downstairs - D handshape down', confidence: 94, category: 'locations' },
            'north': { emoji: '🧭', name: 'ASL North', description: 'ASL sign for north - N handshape pointing up', confidence: 93, category: 'locations' },
            'south': { emoji: '🧭', name: 'ASL South', description: 'ASL sign for south - S handshape pointing down', confidence: 93, category: 'locations' },
            'east': { emoji: '🧭', name: 'ASL East', description: 'ASL sign for east - E handshape pointing right', confidence: 93, category: 'locations' },
            'west': { emoji: '🧭', name: 'ASL West', description: 'ASL sign for west - W handshape pointing left', confidence: 93, category: 'locations' }
        };

        // Enhanced gesture database with sign language support
        const signLanguageDatabase = {
            asl: {
                'hello': { emoji: '👋', name: 'ASL Hello', description: 'American Sign Language greeting', confidence: 95, category: 'greetings' },
                'thank you': { emoji: '🙏', name: 'ASL Thank You', description: 'ASL sign for gratitude', confidence: 97, category: 'expressions' },
                'please': { emoji: '🙏', name: 'ASL Please', description: 'ASL sign for polite request', confidence: 93, category: 'expressions' },
                'sorry': { emoji: '😔', name: 'ASL Sorry', description: 'ASL sign for apology', confidence: 91, category: 'expressions' },
                'yes': { emoji: '👍', name: 'ASL Yes', description: 'ASL affirmative sign', confidence: 96, category: 'actions' },
                'no': { emoji: '👎', name: 'ASL No', description: 'ASL negative sign', confidence: 94, category: 'actions' },
                'help': { emoji: '🙋‍♂️', name: 'ASL Help', description: 'ASL sign for assistance', confidence: 94, category: 'expressions' },
                'love': { emoji: '❤️', name: 'ASL Love', description: 'ASL sign for love', confidence: 96, category: 'emotions' },
                'goodbye': { emoji: '👋', name: 'ASL Goodbye', description: 'ASL farewell sign', confidence: 92, category: 'greetings' },
                'good morning': { emoji: '🌅', name: 'ASL Good Morning', description: 'ASL morning greeting', confidence: 94, category: 'greetings' },
                'good night': { emoji: '🌙', name: 'ASL Good Night', description: 'ASL night farewell', confidence: 93, category: 'greetings' }
            },
            bsl: {
                'hello': { emoji: '👋', name: 'BSL Hello', description: 'British Sign Language greeting', confidence: 95, category: 'greetings' },
                'thank you': { emoji: '🙏', name: 'BSL Thank You', description: 'BSL sign for gratitude', confidence: 97, category: 'expressions' },
                'please': { emoji: '🙏', name: 'BSL Please', description: 'BSL sign for polite request', confidence: 93, category: 'expressions' },
                'sorry': { emoji: '😔', name: 'BSL Sorry', description: 'BSL sign for apology', confidence: 91, category: 'expressions' },
                'yes': { emoji: '👍', name: 'BSL Yes', description: 'BSL affirmative sign', confidence: 96, category: 'actions' },
                'no': { emoji: '👎', name: 'BSL No', description: 'BSL negative sign', confidence: 94, category: 'actions' },
                'help': { emoji: '🙋‍♂️', name: 'BSL Help', description: 'BSL sign for assistance', confidence: 94, category: 'expressions' },
                'love': { emoji: '❤️', name: 'BSL Love', description: 'BSL sign for love', confidence: 96, category: 'emotions' },
                'goodbye': { emoji: '👋', name: 'BSL Goodbye', description: 'BSL farewell sign', confidence: 92, category: 'greetings' }
            },
            isl: {
                'hello': { emoji: '👋', name: 'ISL Hello', description: 'Indian Sign Language greeting', confidence: 95, category: 'greetings' },
                'thank you': { emoji: '🙏', name: 'ISL Thank You', description: 'ISL sign for gratitude', confidence: 97, category: 'expressions' },
                'please': { emoji: '🙏', name: 'ISL Please', description: 'ISL sign for polite request', confidence: 93, category: 'expressions' },
                'namaste': { emoji: '🙏', name: 'ISL Namaste', description: 'Traditional Indian greeting sign', confidence: 98, category: 'greetings' },
                'yes': { emoji: '👍', name: 'ISL Yes', description: 'ISL affirmative sign', confidence: 96, category: 'actions' },
                'no': { emoji: '👎', name: 'ISL No', description: 'ISL negative sign', confidence: 94, category: 'actions' },
                'help': { emoji: '🙋‍♂️', name: 'ISL Help', description: 'ISL sign for assistance', confidence: 94, category: 'expressions' },
                'love': { emoji: '❤️', name: 'ISL Love', description: 'ISL sign for love', confidence: 96, category: 'emotions' }
            },
            jsl: {
                'hello': { emoji: '👋', name: 'JSL Hello', description: 'Japanese Sign Language greeting', confidence: 95, category: 'greetings' },
                'thank you': { emoji: '🙏', name: 'JSL Thank You', description: 'JSL sign for gratitude', confidence: 97, category: 'expressions' },
                'please': { emoji: '🙏', name: 'JSL Please', description: 'JSL sign for polite request', confidence: 93, category: 'expressions' },
                'sorry': { emoji: '😔', name: 'JSL Sorry', description: 'JSL sign for apology', confidence: 91, category: 'expressions' },
                'yes': { emoji: '👍', name: 'JSL Yes', description: 'JSL affirmative sign', confidence: 96, category: 'actions' },
                'no': { emoji: '👎', name: 'JSL No', description: 'JSL negative sign', confidence: 94, category: 'actions' },
                'help': { emoji: '🙋‍♂️', name: 'JSL Help', description: 'JSL sign for assistance', confidence: 94, category: 'expressions' },
                'love': { emoji: '❤️', name: 'JSL Love', description: 'JSL sign for love', confidence: 96, category: 'emotions' }
            },
            ksl: {
                'hello': { emoji: '👋', name: 'KSL Hello', description: 'Korean Sign Language greeting', confidence: 95, category: 'greetings' },
                'thank you': { emoji: '🙏', name: 'KSL Thank You', description: 'KSL sign for gratitude', confidence: 97, category: 'expressions' },
                'please': { emoji: '🙏', name: 'KSL Please', description: 'KSL sign for polite request', confidence: 93, category: 'expressions' },
                'sorry': { emoji: '😔', name: 'KSL Sorry', description: 'KSL sign for apology', confidence: 91, category: 'expressions' },
                'yes': { emoji: '👍', name: 'KSL Yes', description: 'KSL affirmative sign', confidence: 96, category: 'actions' },
                'no': { emoji: '👎', name: 'KSL No', description: 'KSL negative sign', confidence: 94, category: 'actions' },
                'help': { emoji: '🙋‍♂️', name: 'KSL Help', description: 'KSL sign for assistance', confidence: 94, category: 'expressions' },
                'love': { emoji: '❤️', name: 'KSL Love', description: 'KSL sign for love', confidence: 96, category: 'emotions' }
            }
        };
        
        // Text-to-Speech variables
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        let availableVoices = [];
        
        // Advanced Voice Control variables
        let voiceCommands = new Map();
        let isListeningForCommands = false;
        let commandMode = false;
        let wakeWord = 'jarvis';
        let voiceFeedback = true;
        let autoResponse = true;
        let customCommands = new Map();
        let gestureSequence = [];
        let isSequenceMode = false;

        // DOM Elements
        const textInput = document.getElementById('textInput');
        const processTextBtn = document.getElementById('processTextBtn');
        const recordBtn = document.getElementById('recordBtn');
        const stopBtn = document.getElementById('stopBtn');
        const clearBtn = document.getElementById('clearBtn');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const gestureDisplay = document.getElementById('gestureDisplay');
        const historyList = document.getElementById('historyList');
        const confidencePercent = document.getElementById('confidencePercent');
        const statusDisplay = document.getElementById('statusDisplay');
        const audioVisualization = document.getElementById('audioVisualization');
        const transcriptionDisplay = document.getElementById('transcriptionDisplay');
        const transcriptionText = document.getElementById('transcriptionText');
        
        // Text-to-Speech elements
        const ttsText = document.getElementById('ttsText');
        const voiceSelect = document.getElementById('voiceSelect');
        const speedSelect = document.getElementById('speedSelect');
        const speakBtn = document.getElementById('speakBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const stopSpeakBtn = document.getElementById('stopSpeakBtn');
        const ttsStatus = document.getElementById('ttsStatus');

        // Advanced Voice Control Functions
        function initializeVoiceCommands() {
            // System commands
            voiceCommands.set('open dashboard', () => {
                speakResponse('Dashboard is now active');
                showStatus('Dashboard activated', 'success');
            });
            
            voiceCommands.set('clear all', () => {
                clearAll();
                speakResponse('All cleared');
            });
            
            voiceCommands.set('stop listening', () => {
                stopCommandMode();
                speakResponse('Voice control deactivated');
            });
            
            voiceCommands.set('start listening', () => {
                startCommandMode();
                speakResponse('Voice control activated');
            });
            
            voiceCommands.set('system status', () => {
                const status = `System status: ${stats.totalGestures} gestures detected, average confidence ${Math.round(stats.totalConfidence / Math.max(1, stats.totalGestures))}%`;
                speakResponse(status);
            });
            
            // Gesture commands
            voiceCommands.set('show hello', () => {
                const gesture = detectGesture('hello');
                displayGesture(gesture, 'hello');
                speakResponse('Showing hello gesture');
            });
            
            voiceCommands.set('show love', () => {
                const gesture = detectGesture('love');
                displayGesture(gesture, 'love');
                speakResponse('Showing love gesture');
            });
            
            voiceCommands.set('show thank you', () => {
                const gesture = detectGesture('thank you');
                displayGesture(gesture, 'thank you');
                speakResponse('Showing thank you gesture');
            });
            
            voiceCommands.set('show goodbye', () => {
                const gesture = detectGesture('goodbye');
                displayGesture(gesture, 'goodbye');
                speakResponse('Showing goodbye gesture');
            });
            
            // Utility commands
            voiceCommands.set('what time is it', () => {
                const time = new Date().toLocaleTimeString();
                speakResponse(`The current time is ${time}`);
            });
            
            voiceCommands.set('what day is it', () => {
                const day = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                speakResponse(`Today is ${day}`);
            });
            
            voiceCommands.set('how are you', () => {
                speakResponse('I am functioning perfectly. How can I assist you today?');
            });
            
            voiceCommands.set('who are you', () => {
                speakResponse('I am Jarvis, your advanced AI assistant with voice control capabilities.');
            });
            
            // Sequence commands
            voiceCommands.set('start sequence', () => {
                startGestureSequence();
            });
            
            voiceCommands.set('play sequence', () => {
                playSequence();
            });
            
            voiceCommands.set('clear sequence', () => {
                clearSequence();
            });
            
            // Advanced system commands
            voiceCommands.set('toggle voice feedback', () => {
                voiceFeedback = !voiceFeedback;
                speakResponse(`Voice feedback ${voiceFeedback ? 'enabled' : 'disabled'}`);
            });
            
            voiceCommands.set('list commands', () => {
                const commandList = Array.from(voiceCommands.keys()).join(', ');
                speakResponse(`Available commands: ${commandList}`);
            });
            
            voiceCommands.set('help', () => {
                speakResponse('I can help you with gestures, sequences, system status, and more. Say "Jarvis, list commands" for all available commands.');
            });
        }
        
        function startCommandMode() {
            commandMode = true;
            isListeningForCommands = true;
            showStatus('Voice command mode activated. Say "Jarvis" followed by your command', 'success');
            updateVoiceControlUI();
        }
        
        function stopCommandMode() {
            commandMode = false;
            isListeningForCommands = false;
            showStatus('Voice command mode deactivated', 'error');
            updateVoiceControlUI();
        }
        
        function processVoiceCommand(transcript) {
            console.log('Processing voice command:', transcript);
            const cleanTranscript = transcript.toLowerCase().trim();
            console.log('Clean transcript:', cleanTranscript);
            console.log('Wake word:', wakeWord);
            
            // Check for wake word
            if (cleanTranscript.includes(wakeWord)) {
                const command = cleanTranscript.replace(wakeWord, '').trim();
                console.log('Command extracted:', command);
                
                // Handle sequence mode
                if (isSequenceMode) {
                    if (command.includes('play sequence')) {
                        playSequence();
                        return true;
                    } else if (command.includes('clear sequence')) {
                        clearSequence();
                        return true;
                    } else if (command.includes('end sequence')) {
                        isSequenceMode = false;
                        speakResponse('Sequence mode ended');
                        return true;
                    } else {
                        // Add gesture to sequence
                        addToSequence(command);
                        return true;
                    }
                }
                
                // Check custom commands first
                if (customCommands.has(command)) {
                    customCommands.get(command)();
                    return true;
                }
                
                // Execute built-in command if found
                if (voiceCommands.has(command)) {
                    voiceCommands.get(command)();
                    return true;
                } else {
                    // Try partial matching
                    for (const [cmd, func] of voiceCommands) {
                        if (command.includes(cmd) || cmd.includes(command)) {
                            func();
                            return true;
                        }
                    }
                    
                    // Check for sequence commands
                    if (command.includes('start sequence')) {
                        startGestureSequence();
                        return true;
                    }
                    
                    // No command found
                    speakResponse('Command not recognized. Please try again.');
                    return false;
                }
            }
            
            return false;
        }
        
        function speakResponse(text) {
            if (!voiceFeedback) return;
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 1.2;
            utterance.pitch = 1.1;
            utterance.volume = 0.8;
            
            // Set voice if available
            if (availableVoices.length > 0) {
                utterance.voice = availableVoices[0];
            }
            
            speechSynthesis.speak(utterance);
        }
        
        function updateVoiceControlUI() {
            const voiceControlBtn = document.getElementById('voiceControlBtn');
            if (voiceControlBtn) {
                if (commandMode) {
                    voiceControlBtn.textContent = '🎤 Voice Active';
                    voiceControlBtn.className = 'btn btn-primary';
                } else {
                    voiceControlBtn.textContent = '🎤 Activate Voice';
                    voiceControlBtn.className = 'btn btn-secondary';
                }
            }
        }
        
        function addCustomCommand(trigger, action) {
            customCommands.set(trigger.toLowerCase(), action);
            speakResponse(`Custom command "${trigger}" added successfully`);
        }
        
        function removeCustomCommand(trigger) {
            if (customCommands.has(trigger.toLowerCase())) {
                customCommands.delete(trigger.toLowerCase());
                speakResponse(`Custom command "${trigger}" removed`);
                return true;
            }
            return false;
        }
        
        function startGestureSequence() {
            isSequenceMode = true;
            gestureSequence = [];
            speakResponse('Gesture sequence mode activated. Say gestures to add to sequence');
        }
        
        function addToSequence(gestureName) {
            const gesture = detectGesture(gestureName);
            gestureSequence.push(gesture);
            speakResponse(`${gesture.name} added to sequence. ${gestureSequence.length} gestures in sequence`);
        }
        
        function playSequence() {
            if (gestureSequence.length === 0) {
                speakResponse('No gestures in sequence');
                return;
            }
            
            speakResponse(`Playing sequence with ${gestureSequence.length} gestures`);
            let index = 0;
            
            function playNext() {
                if (index < gestureSequence.length) {
                    const gesture = gestureSequence[index];
                    displayGesture(gesture, `sequence-${index}`);
                    speakResponse(gesture.name);
                    index++;
                    setTimeout(playNext, 2000);
                } else {
                    speakResponse('Sequence complete');
                    isSequenceMode = false;
                }
            }
            
            playNext();
        }
        
        function clearSequence() {
            gestureSequence = [];
            isSequenceMode = false;
            speakResponse('Gesture sequence cleared');
        }

        // Text-to-Speech Functions
        function loadVoices() {
            availableVoices = speechSynthesis.getVoices();
            voiceSelect.innerHTML = '';
            
            if (availableVoices.length === 0) {
                voiceSelect.innerHTML = '<option value="">No voices available</option>';
                return;
            }
            
            // Add default option
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'Select a voice...';
            voiceSelect.appendChild(defaultOption);
            
            // Add available voices
            availableVoices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${voice.name} (${voice.lang})`;
                voiceSelect.appendChild(option);
            });
        }
        
        function speakText() {
            const text = ttsText.value.trim();
            if (!text) {
                showTTSStatus('Please enter text to speak', 'error');
                return;
            }
            
            // Stop any current speech
            if (currentUtterance) {
                speechSynthesis.cancel();
            }
            
            // Create new utterance
            currentUtterance = new SpeechSynthesisUtterance(text);
            
            // Set voice
            const selectedVoiceIndex = voiceSelect.value;
            if (selectedVoiceIndex && availableVoices[selectedVoiceIndex]) {
                currentUtterance.voice = availableVoices[selectedVoiceIndex];
            }
            
            // Set speed
            const speed = parseFloat(speedSelect.value);
            currentUtterance.rate = speed;
            
            // Set pitch and volume
            currentUtterance.pitch = 1;
            currentUtterance.volume = 1;
            
            // Event handlers
            currentUtterance.onstart = () => {
                showTTSStatus('Speaking...', 'success');
                speakBtn.disabled = true;
                pauseBtn.disabled = false;
                stopSpeakBtn.disabled = false;
            };
            
            currentUtterance.onend = () => {
                showTTSStatus('Finished speaking', 'success');
                resetTTSControls();
            };
            
            currentUtterance.onerror = (event) => {
                showTTSStatus(`Error: ${event.error}`, 'error');
                resetTTSControls();
            };
            
            // Start speaking
            speechSynthesis.speak(currentUtterance);
        }
        
        function pauseSpeech() {
            if (speechSynthesis.speaking) {
                speechSynthesis.pause();
                showTTSStatus('Paused', 'processing');
                pauseBtn.textContent = '▶️ Resume';
                pauseBtn.onclick = resumeSpeech;
            }
        }
        
        function resumeSpeech() {
            if (speechSynthesis.paused) {
                speechSynthesis.resume();
                showTTSStatus('Speaking...', 'success');
                pauseBtn.textContent = '⏸️ Pause';
                pauseBtn.onclick = pauseSpeech;
            }
        }
        
        function stopSpeech() {
            speechSynthesis.cancel();
            showTTSStatus('Stopped', 'error');
            resetTTSControls();
        }
        
        function resetTTSControls() {
            speakBtn.disabled = false;
            pauseBtn.disabled = true;
            stopSpeakBtn.disabled = true;
            pauseBtn.textContent = '⏸️ Pause';
            pauseBtn.onclick = pauseSpeech;
            currentUtterance = null;
        }
        
        function showTTSStatus(message, type) {
            ttsStatus.textContent = message;
            ttsStatus.className = `status ${type}`;
            ttsStatus.style.display = 'block';
            
            // Auto-hide success messages after 3 seconds
            if (type === 'success') {
                setTimeout(() => {
                    ttsStatus.style.display = 'none';
                }, 3000);
            }
        }
        
        // ASL Finger Spelling Function
        function fingerSpell(text) {
            const letters = text.toLowerCase().split('');
            const spelledWord = letters.map(letter => {
                if (advancedASLDatabase[letter]) {
                    return advancedASLDatabase[letter];
                }
                return null;
            }).filter(gesture => gesture !== null);

            if (spelledWord.length > 0) {
                return {
                    emoji: '🤟',
                    name: `ASL Finger Spelling: ${text.toUpperCase()}`,
                    description: `Spelling: ${text.toUpperCase()}`,
                    confidence: 95,
                    category: 'fingerspelling',
                    letters: spelledWord
                };
            }
            return null;
        }

        // ASL Hand Tracking Simulation
        function simulateHandTracking() {
            const handPositions = [
                { x: 100, y: 200, gesture: 'open_palm' },
                { x: 150, y: 180, gesture: 'pointing' },
                { x: 200, y: 160, gesture: 'fist' },
                { x: 250, y: 140, gesture: 'thumbs_up' },
                { x: 300, y: 120, gesture: 'peace_sign' }
            ];

            return handPositions[Math.floor(Math.random() * handPositions.length)];
        }

        // Enhanced ASL Detection with Advanced Features
        function detectAdvancedASL(text) {
            const inputText = text.toLowerCase().trim();
            
            // Check for finger spelling first
            if (inputText.length <= 5 && /^[a-z]+$/.test(inputText)) {
                const fingerSpelled = fingerSpell(inputText);
                if (fingerSpelled) {
                    return fingerSpelled;
                }
            }

            // Check advanced ASL database
            if (advancedASLDatabase[inputText]) {
                return advancedASLDatabase[inputText];
            }

            // Check for partial matches in advanced ASL
            for (const key in advancedASLDatabase) {
                if (inputText.includes(key) || key.includes(inputText)) {
                    const gesture = {...advancedASLDatabase[key]};
                    gesture.confidence = Math.max(70, gesture.confidence - 15);
                    return gesture;
                }
            }

            // Check original ASL database
            if (signLanguageDatabase.asl && signLanguageDatabase.asl[inputText]) {
                return signLanguageDatabase.asl[inputText];
            }

            // Check original gesture database
            if (gestureDatabase[inputText]) {
                return gestureDatabase[inputText];
            }

            // No match found
            return {
                emoji: '🤷‍♂️',
                name: 'Unknown ASL Sign',
                description: 'Could not detect an ASL sign for this input. Try finger spelling individual letters.',
                confidence: 10,
                category: 'unknown'
            };
        }

        // ASL Practice Mode
        function startASLPractice() {
            const practiceWords = [
                'hello', 'thank you', 'please', 'sorry', 'yes', 'no',
                'family', 'mother', 'father', 'sister', 'brother',
                'one', 'two', 'three', 'four', 'five',
                'red', 'blue', 'green', 'yellow',
                'eat', 'drink', 'hungry', 'thirsty',
                'learn', 'teach', 'school', 'student',
                'work', 'job', 'money', 'buy',
                'car', 'bus', 'train', 'airplane',
                'sun', 'rain', 'snow', 'hot', 'cold',
                'head', 'eye', 'ear', 'nose', 'mouth',
                'understand', 'know', 'think', 'remember',
                'create', 'build', 'fix', 'break',
                'friend', 'enemy', 'neighbor', 'stranger',
                'what', 'where', 'when', 'why', 'how', 'who',
                'big', 'small', 'tall', 'short', 'long',
                'here', 'there', 'inside', 'outside'
            ];

            const randomWord = practiceWords[Math.floor(Math.random() * practiceWords.length)];
            const gesture = detectAdvancedASL(randomWord);
            
            displayGesture(gesture, randomWord);
            speakResponse(`Practice the ASL sign for: ${randomWord}`);
            
            return { word: randomWord, gesture: gesture };
        }

        // ASL Quiz Mode
        function startASLQuiz() {
            const quizQuestions = [
                {
                    question: "What is the ASL sign for 'family'?",
                    options: ["F handshape moving in circle", "F handshape on chest", "F handshape pointing", "F handshape on head"],
                    correct: 0,
                    word: "family"
                },
                {
                    question: "What is the ASL sign for 'learn'?",
                    options: ["L handshape on forehead", "L handshape on chest", "L handshape moving", "L handshape pointing"],
                    correct: 0,
                    word: "learn"
                },
                {
                    question: "What is the ASL sign for 'money'?",
                    options: ["M handshape rubbing", "M handshape on chest", "M handshape pointing", "M handshape moving"],
                    correct: 0,
                    word: "money"
                },
                {
                    question: "What is the ASL sign for 'understand'?",
                    options: ["Index finger on forehead", "Index finger on temple", "Index finger on chin", "Index finger pointing"],
                    correct: 0,
                    word: "understand"
                },
                {
                    question: "What is the ASL sign for 'friend'?",
                    options: ["F handshape on chest", "F handshape moving", "F handshape pointing", "F handshape on head"],
                    correct: 0,
                    word: "friend"
                }
            ];

            const randomQuestion = quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
            
            // Display quiz question
            const quizDisplay = document.createElement('div');
            quizDisplay.innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 15px; margin: 20px 0;">
                    <h3 style="margin-bottom: 15px; color: #333;">ASL Quiz</h3>
                    <p style="margin-bottom: 15px; font-weight: 600;">${randomQuestion.question}</p>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        ${randomQuestion.options.map((option, index) => `
                            <button class="btn btn-secondary quiz-option" data-correct="${index === randomQuestion.correct}" style="text-align: left;">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;

            // Add event listeners for quiz options
            setTimeout(() => {
                quizDisplay.querySelectorAll('.quiz-option').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const isCorrect = e.target.dataset.correct === 'true';
                        if (isCorrect) {
                            e.target.style.background = 'linear-gradient(45deg, #28a745, #20c997)';
                            e.target.style.color = 'white';
                            speakResponse('Correct! Well done!');
                        } else {
                            e.target.style.background = '#dc3545';
                            e.target.style.color = 'white';
                            speakResponse('Incorrect. Try again!');
                        }
                        
                        // Show correct answer
                        setTimeout(() => {
                            const correctBtn = quizDisplay.querySelector('[data-correct="true"]');
                            correctBtn.style.background = 'linear-gradient(45deg, #28a745, #20c997)';
                            correctBtn.style.color = 'white';
                        }, 1000);
                    });
                });
            }, 100);

            return { question: randomQuestion, display: quizDisplay };
        }

        // Enhanced gesture detection function with sign language support
        function detectGesture(text) {
            const inputText = text.toLowerCase().trim();
           
            // Check advanced ASL database first
            if (advancedASLDatabase[inputText]) {
                return advancedASLDatabase[inputText];
            }
           
            // Check selected sign language database
            if (signLanguageDatabase[selectedSignLanguage] && signLanguageDatabase[selectedSignLanguage][inputText]) {
                return signLanguageDatabase[selectedSignLanguage][inputText];
            }
           
            // Check all sign language databases
            for (const lang in signLanguageDatabase) {
                if (signLanguageDatabase[lang][inputText]) {
                    const gesture = {...signLanguageDatabase[lang][inputText]};
                    gesture.confidence = Math.max(60, gesture.confidence - 10); // Slight reduction for cross-language
                    return gesture;
                }
            }
           
            // Check original gesture database
            if (gestureDatabase[inputText]) {
                return gestureDatabase[inputText];
            }
           
            // Partial match across all databases
            for (const lang in signLanguageDatabase) {
                for (const key in signLanguageDatabase[lang]) {
                    if (inputText.includes(key) || key.includes(inputText)) {
                        const gesture = {...signLanguageDatabase[lang][key]};
                        gesture.confidence = Math.max(50, gesture.confidence - 25);
                        return gesture;
                    }
                }
            }
           
            // Partial match in original database
            for (const key in gestureDatabase) {
                if (inputText.includes(key) || key.includes(inputText)) {
                    const gesture = {...gestureDatabase[key]};
                    gesture.confidence = Math.max(60, gesture.confidence - 20);
                    return gesture;
                }
            }
           
            // No match found
            return {
                emoji: '🤷‍♂️',
                name: 'Unknown Gesture',
                description: 'Could not detect a gesture for this input',
                confidence: 15,
                category: 'unknown'
            };
        }

        // AI Model Training Functions
        function startTraining() {
            if (isTraining) return;
            
            isTraining = true;
            currentEpoch = 0;
            currentAccuracy = 0;
            currentLoss = 1.0;
            
            document.getElementById('startTrainingBtn').disabled = true;
            document.getElementById('stopTrainingBtn').disabled = false;
            
            // Simulate training process
            trainingInterval = setInterval(() => {
                currentEpoch++;
                currentLoss = Math.max(0.1, currentLoss - 0.008);
                currentAccuracy = Math.min(95, currentAccuracy + 0.8);
                
                updateTrainingProgress();
                
                if (currentEpoch >= totalEpochs) {
                    stopTraining();
                }
            }, 100);
            
            showStatus('AI model training started...', 'processing');
        }
        
        function stopTraining() {
            if (!isTraining) return;
            
            isTraining = false;
            clearInterval(trainingInterval);
            
            document.getElementById('startTrainingBtn').disabled = false;
            document.getElementById('stopTrainingBtn').disabled = true;
            
            showStatus('AI model training completed!', 'success');
            updateLastUpdated();
        }
        
        function updateTrainingProgress() {
            const epochProgress = document.getElementById('epochProgress');
            const epochBar = document.getElementById('epochBar');
            const accuracyDisplay = document.getElementById('accuracyDisplay');
            const accuracyBar = document.getElementById('accuracyBar');
            const lossDisplay = document.getElementById('lossDisplay');
            const learningRateDisplay = document.getElementById('learningRateDisplay');
            
            epochProgress.textContent = `${currentEpoch}/${totalEpochs}`;
            epochBar.style.width = `${(currentEpoch / totalEpochs) * 100}%`;
            accuracyDisplay.textContent = `${Math.round(currentAccuracy)}%`;
            accuracyBar.style.width = `${currentAccuracy}%`;
            lossDisplay.textContent = currentLoss.toFixed(3);
            learningRateDisplay.textContent = learningRate.toFixed(3);
        }
        
        function saveModel() {
            const modelData = {
                version: modelVersion,
                trainingData: trainingData,
                accuracy: currentAccuracy,
                loss: currentLoss,
                signLanguage: selectedSignLanguage,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(modelData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `sign-language-model-${modelVersion}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showStatus('Model saved successfully!', 'success');
        }
        
        function loadModel() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const modelData = JSON.parse(event.target.result);
                            trainingData = modelData.trainingData || [];
                            currentAccuracy = modelData.accuracy || 0;
                            currentLoss = modelData.loss || 0;
                            selectedSignLanguage = modelData.signLanguage || 'asl';
                            modelVersion = modelData.version || 'v1.0';
                            
                            updateTrainingProgress();
                            updateTrainingStats();
                            showStatus('Model loaded successfully!', 'success');
                        } catch (error) {
                            showStatus('Error loading model: ' + error.message, 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }
        
        function addTrainingData() {
            const word = document.getElementById('signWord').value.trim();
            const description = document.getElementById('signDescription').value.trim();
            const category = document.getElementById('signCategory').value;
            
            if (!word || !description) {
                showStatus('Please fill in all fields', 'error');
                return;
            }
            
            const newSign = {
                word: word.toLowerCase(),
                description: description,
                category: category,
                signLanguage: selectedSignLanguage,
                timestamp: new Date().toISOString()
            };
            
            trainingData.push(newSign);
            
            // Add to sign language database
            if (!signLanguageDatabase[selectedSignLanguage]) {
                signLanguageDatabase[selectedSignLanguage] = {};
            }
            
            signLanguageDatabase[selectedSignLanguage][word] = {
                emoji: '🤟',
                name: `${selectedSignLanguage.toUpperCase()} ${word.charAt(0).toUpperCase() + word.slice(1)}`,
                description: description,
                confidence: 85,
                category: category
            };
            
            // Clear form
            document.getElementById('signWord').value = '';
            document.getElementById('signDescription').value = '';
            
            updateTrainingStats();
            showStatus('Training data added successfully!', 'success');
        }
        
        function updateTrainingStats() {
            document.getElementById('totalSigns').textContent = trainingData.length;
            document.getElementById('trainingAccuracy').textContent = `${Math.round(currentAccuracy)}%`;
            document.getElementById('modelVersion').textContent = modelVersion;
        }
        
        function updateLastUpdated() {
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }
        
        function exportTrainingData() {
            const dataStr = JSON.stringify(trainingData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `training-data-${selectedSignLanguage}-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showStatus('Training data exported successfully!', 'success');
        }
        
        function importTrainingData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const importedData = JSON.parse(event.target.result);
                            trainingData = trainingData.concat(importedData);
                            updateTrainingStats();
                            showStatus('Training data imported successfully!', 'success');
                        } catch (error) {
                            showStatus('Error importing data: ' + error.message, 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }
        
        // ChatGPT Integration Functions
        async function askChatGPT() {
            const prompt = document.getElementById('chatgptPrompt').value.trim();
            if (!prompt) {
                showStatus('Please enter a prompt for ChatGPT', 'error');
                return;
            }
            
            const responseDiv = document.getElementById('chatgptResponse');
            responseDiv.textContent = '🤖 ChatGPT is thinking...';
            
            try {
                // Simulate ChatGPT API call (in real implementation, you'd use actual OpenAI API)
                const response = await simulateChatGPTResponse(prompt);
                responseDiv.textContent = response;
                showStatus('ChatGPT response received!', 'success');
            } catch (error) {
                responseDiv.textContent = '❌ Error: ' + error.message;
                showStatus('Error getting ChatGPT response', 'error');
            }
        }
        
        function simulateChatGPTResponse(prompt) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const responses = {
                        'help with sign language': 'I can help you with sign language training! Here are some tips:\n\n1. Start with basic greetings like "hello" and "thank you"\n2. Practice facial expressions - they\'re crucial in sign language\n3. Use clear hand movements and maintain eye contact\n4. Learn the alphabet first, then move to words\n5. Practice with native signers when possible',
                        'training tips': 'Here are advanced training tips for sign language AI:\n\n1. Collect diverse training data from different regions\n2. Include variations in signing styles\n3. Add context and facial expressions to your dataset\n4. Use video recordings for better accuracy\n5. Implement real-time feedback systems',
                        'model improvement': 'To improve your sign language model:\n\n1. Increase training data diversity\n2. Implement data augmentation techniques\n3. Use transfer learning from related models\n4. Add gesture recognition from video input\n5. Include cultural context in training',
                        'accuracy': 'To improve accuracy:\n\n1. Use more training examples per sign\n2. Include different lighting conditions\n3. Add various hand positions and movements\n4. Implement confidence scoring\n5. Use ensemble methods for better predictions'
                    };
                    
                    let response = 'I\'m here to help with your sign language AI training! ';
                    
                    if (prompt.toLowerCase().includes('help')) {
                        response += responses['help with sign language'];
                    } else if (prompt.toLowerCase().includes('training')) {
                        response += responses['training tips'];
                    } else if (prompt.toLowerCase().includes('model')) {
                        response += responses['model improvement'];
                    } else if (prompt.toLowerCase().includes('accuracy')) {
                        response += responses['accuracy'];
                    } else {
                        response += 'For sign language training, I recommend:\n\n1. Start with basic signs\n2. Practice regularly\n3. Use video recordings\n4. Get feedback from native signers\n5. Build a comprehensive dataset';
                    }
                    
                    resolve(response);
                }, 2000);
            });
        }
        
        function copyResponse() {
            const response = document.getElementById('chatgptResponse').textContent;
            navigator.clipboard.writeText(response).then(() => {
                showStatus('Response copied to clipboard!', 'success');
            }).catch(() => {
                showStatus('Failed to copy response', 'error');
            });
        }

        // Display gesture function
        function displayGesture(gesture, inputText) {
            const avatar = gestureDisplay.querySelector('.gesture-avatar');
            const name = gestureDisplay.querySelector('.gesture-text');
            const description = gestureDisplay.querySelector('.gesture-description');
            const confidenceFill = gestureDisplay.querySelector('.confidence-fill');

            avatar.textContent = gesture.emoji;
            name.textContent = gesture.name;
            description.textContent = gesture.description;
            confidencePercent.textContent = gesture.confidence + '%';
            confidenceFill.style.width = gesture.confidence + '%';

            // Add to history
            addToHistory(gesture, inputText);
            updateStats(gesture);
        }

        // Add to history
        function addToHistory(gesture, inputText) {
            const historyItem = {
                gesture,
                inputText,
                timestamp: new Date()
            };

            history.unshift(historyItem);
            if (history.length > 10) {
                history.pop();
            }

            updateHistoryDisplay();
        }

        // Update history display
        function updateHistoryDisplay() {
            if (history.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No gestures detected yet</p>';
                return;
            }

            historyList.innerHTML = history.map(item => `
                <div class="history-item" data-text="${item.inputText}">
                    <div class="history-emoji">${item.gesture.emoji}</div>
                    <div class="history-text">
                        <div style="font-weight: 600;">${item.gesture.name}</div>
                        <div style="font-size: 0.9em; color: #666;">"${item.inputText}"</div>
                    </div>
                    <div class="history-time">${item.timestamp.toLocaleTimeString()}</div>
                </div>
            `).join('');
        }

        // Update stats
        function updateStats(gesture) {
            stats.totalGestures++;
            stats.totalConfidence += gesture.confidence;

            if (!stats.categoryCount[gesture.category]) {
                stats.categoryCount[gesture.category] = 0;
            }
            stats.categoryCount[gesture.category]++;

            const avgConfidence = Math.round(stats.totalConfidence / stats.totalGestures);
            const topCategory = Object.keys(stats.categoryCount).reduce((a, b) =>
                stats.categoryCount[a] > stats.categoryCount[b] ? a : b
            );

            document.getElementById('totalGestures').textContent = stats.totalGestures;
            document.getElementById('avgConfidence').textContent = avgConfidence + '%';
            document.getElementById('topCategory').textContent = topCategory;
        }

        // Process text function
        function processText() {
            const text = textInput.value.trim();
            if (!text) return;

            const gesture = detectGesture(text);
            displayGesture(gesture, text);
        }

        // Clear all function
        function clearAll() {
            textInput.value = '';
           
            // Stop recording if active
            if (isRecording) {
                stopRecording();
            }
           
            // Clear status and transcription
            statusDisplay.innerHTML = '';
            transcriptionDisplay.style.display = 'none';
           
            // Reset display
            const avatar = gestureDisplay.querySelector('.gesture-avatar');
            const name = gestureDisplay.querySelector('.gesture-text');
            const description = gestureDisplay.querySelector('.gesture-description');
            const confidenceFill = gestureDisplay.querySelector('.confidence-fill');

            avatar.textContent = '🤷‍♂️';
            name.textContent = 'Ready to detect gestures!';
            description.textContent = 'Enter text or record audio to see AI-powered gesture predictions';
            confidencePercent.textContent = '0%';
            confidenceFill.style.width = '0%';
        }

        // Audio recording functions
        function initializeSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
            } else if ('SpeechRecognition' in window) {
                recognition = new SpeechRecognition();
            } else {
                console.log('Speech recognition not supported');
                return false;
            }

            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.lang = 'en-US';

            recognition.onstart = function() {
                showStatus('Recording...', 'recording');
                audioVisualization.style.display = 'flex';
            };

            recognition.onresult = function(event) {
                let finalTranscript = '';
                let interimTranscript = '';

                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    if (event.results[i].isFinal) {
                        finalTranscript += transcript;
                    } else {
                        interimTranscript += transcript;
                    }
                }

                const displayText = finalTranscript || interimTranscript;
                if (displayText.trim()) {
                    transcriptionText.textContent = displayText;
                    transcriptionDisplay.style.display = 'block';
                }

                if (finalTranscript.trim()) {
                    showStatus('Processing speech...', 'processing');
                    setTimeout(() => {
                        // Check if in command mode first
                        if (commandMode && processVoiceCommand(finalTranscript)) {
                            // Command was processed successfully
                            showStatus('Command executed successfully!', 'success');
                        } else {
                            // Process as regular transcription
                            processTranscription(finalTranscript);
                        }
                    }, 500);
                }
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                showStatus('Error: ' + event.error, 'error');
                resetRecordingState();
            };

            recognition.onend = function() {
                resetRecordingState();
                if (isRecording) {
                    // Restart if we're still supposed to be recording
                    recognition.start();
                }
            };

            return true;
        }

        function startRecording() {
            console.log('Starting recording...');
            if (!recognition && !initializeSpeechRecognition()) {
                showStatus('Speech recognition not supported in this browser', 'error');
                return;
            }

            isRecording = true;
            recordBtn.disabled = true;
            stopBtn.disabled = false;
           
            try {
                recognition.start();
                console.log('Speech recognition started successfully');
            } catch (error) {
                console.error('Error starting speech recognition:', error);
                showStatus('Failed to start recording', 'error');
                resetRecordingState();
            }
        }

        function stopRecording() {
            if (recognition && isRecording) {
                isRecording = false;
                recognition.stop();
            }
            resetRecordingState();
        }

        function resetRecordingState() {
            recordBtn.disabled = false;
            stopBtn.disabled = true;
            audioVisualization.style.display = 'none';
           
            if (!transcriptionDisplay.style.display || transcriptionDisplay.style.display === 'none') {
                statusDisplay.innerHTML = '';
            }
        }

        function processTranscription(transcript) {
            const cleanTranscript = transcript.trim();
            if (cleanTranscript) {
                textInput.value = cleanTranscript;
                const gesture = detectGesture(cleanTranscript);
                displayGesture(gesture, cleanTranscript);
                showStatus('Gesture detected successfully!', 'success');
            }
        }

        function showStatus(message, type) {
            statusDisplay.innerHTML = `
                <div class="status ${type}">
                    ${type === 'processing' ? '<div class="loading"></div>' : ''}
                    ${message}
                </div>
            `;
        }

        // Clear history function
        function clearHistory() {
            history = [];
            updateHistoryDisplay();
        }

        // Event listeners
        processTextBtn.addEventListener('click', processText);
        recordBtn.addEventListener('click', startRecording);
        stopBtn.addEventListener('click', stopRecording);
        clearBtn.addEventListener('click', clearAll);
        clearHistoryBtn.addEventListener('click', clearHistory);
        
        // AI Training Event Listeners
        document.getElementById('startTrainingBtn').addEventListener('click', startTraining);
        document.getElementById('stopTrainingBtn').addEventListener('click', stopTraining);
        document.getElementById('saveModelBtn').addEventListener('click', saveModel);
        document.getElementById('loadModelBtn').addEventListener('click', loadModel);
        document.getElementById('addTrainingDataBtn').addEventListener('click', addTrainingData);
        document.getElementById('exportDataBtn').addEventListener('click', exportTrainingData);
        document.getElementById('importDataBtn').addEventListener('click', importTrainingData);
        document.getElementById('askChatGPTBtn').addEventListener('click', askChatGPT);
        document.getElementById('copyResponseBtn').addEventListener('click', copyResponse);

        // ASL Practice and Quiz Event Listeners
        document.getElementById('startPracticeBtn').addEventListener('click', () => {
            const practice = startASLPractice();
            document.getElementById('practiceDisplay').style.display = 'block';
            document.getElementById('practiceDisplay').innerHTML = `
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; color: #333;">Practice Word: <strong>${practice.word}</strong></h4>
                    <p style="color: #666;">${practice.gesture.description}</p>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-primary" onclick="speakResponse('${practice.word}')">🔊 Hear Word</button>
                        <button class="btn btn-secondary" onclick="startASLPractice()">🔄 New Word</button>
                    </div>
                </div>
            `;
            document.getElementById('nextPracticeBtn').disabled = false;
        });

        document.getElementById('nextPracticeBtn').addEventListener('click', () => {
            const practice = startASLPractice();
            document.getElementById('practiceDisplay').innerHTML = `
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; color: #333;">Practice Word: <strong>${practice.word}</strong></h4>
                    <p style="color: #666;">${practice.gesture.description}</p>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-primary" onclick="speakResponse('${practice.word}')">🔊 Hear Word</button>
                        <button class="btn btn-secondary" onclick="startASLPractice()">🔄 New Word</button>
                    </div>
                </div>
            `;
        });

        document.getElementById('startQuizBtn').addEventListener('click', () => {
            const quiz = startASLQuiz();
            document.getElementById('quizDisplay').style.display = 'block';
            document.getElementById('quizDisplay').innerHTML = '';
            document.getElementById('quizDisplay').appendChild(quiz.display);
            document.getElementById('nextQuizBtn').disabled = false;
        });

        document.getElementById('nextQuizBtn').addEventListener('click', () => {
            const quiz = startASLQuiz();
            document.getElementById('quizDisplay').innerHTML = '';
            document.getElementById('quizDisplay').appendChild(quiz.display);
        });

        // ASL Finger Spelling Event Listeners
        document.getElementById('fingerSpellBtn').addEventListener('click', () => {
            const word = document.getElementById('fingerSpellInput').value.trim();
            if (word) {
                const fingerSpelled = fingerSpell(word);
                if (fingerSpelled) {
                    document.getElementById('fingerSpellDisplay').style.display = 'block';
                    document.getElementById('fingerSpellResult').innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 2em; margin-bottom: 10px;">${fingerSpelled.emoji}</div>
                            <h5 style="margin-bottom: 5px;">${fingerSpelled.name}</h5>
                            <p style="color: #666; margin-bottom: 10px;">${fingerSpelled.description}</p>
                            <div style="display: flex; justify-content: center; gap: 5px; flex-wrap: wrap;">
                                ${word.split('').map(letter => `
                                    <span style="background: #667eea; color: white; padding: 5px 8px; border-radius: 4px; font-weight: bold;">
                                        ${letter.toUpperCase()}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    speakResponse(`Finger spelling: ${word}`);
                } else {
                    document.getElementById('fingerSpellDisplay').style.display = 'block';
                    document.getElementById('fingerSpellResult').innerHTML = `
                        <div style="text-align: center; color: #dc3545;">
                            <p>Could not finger spell "${word}". Please use only letters A-Z.</p>
                        </div>
                    `;
                }
            }
        });

        // Quick letter buttons for finger spelling
        document.querySelectorAll('.quick-letter').forEach(btn => {
            btn.addEventListener('click', () => {
                const letter = btn.dataset.letter;
                const currentInput = document.getElementById('fingerSpellInput');
                currentInput.value += letter;
            });
        });

        // Test Jarvis function
        function testJarvis() {
            speakResponse('Jarvis is online and ready to assist you with ASL learning and gesture detection.');
            showStatus('Jarvis test completed successfully!', 'success');
        }
        
        // Sign Language Category Selection
        document.querySelectorAll('.sign-category').forEach(category => {
            category.addEventListener('click', (e) => {
                // Remove active class from all categories
                document.querySelectorAll('.sign-category').forEach(c => {
                    c.style.borderColor = '#e0e0e0';
                    c.style.backgroundColor = 'white';
                });
                
                // Add active class to selected category
                e.target.closest('.sign-category').style.borderColor = '#667eea';
                e.target.closest('.sign-category').style.backgroundColor = '#f8f9fa';
                
                // Update selected sign language
                selectedSignLanguage = e.target.closest('.sign-category').dataset.category;
                
                showStatus(`Switched to ${selectedSignLanguage.toUpperCase()} sign language`, 'success');
            });
        });
        
        // Text-to-Speech event listeners
        speakBtn.addEventListener('click', speakText);
        pauseBtn.addEventListener('click', pauseSpeech);
        stopSpeakBtn.addEventListener('click', stopSpeech);
        
        // Advanced Voice Control event listeners
        const voiceControlBtn = document.getElementById('voiceControlBtn');
        const wakeWordBtn = document.getElementById('wakeWordBtn');
        const voiceCommandsList = document.getElementById('voiceCommandsList');
        const voiceFeedbackToggle = document.getElementById('voiceFeedbackToggle');
        const autoResponseToggle = document.getElementById('autoResponseToggle');
        
        // Debug: Check if elements exist
        if (!voiceControlBtn) {
            console.error('Voice control button not found!');
        }
        if (!wakeWordBtn) {
            console.error('Wake word button not found!');
        }
        if (!voiceCommandsList) {
            console.error('Voice commands list not found!');
        }
        if (!voiceFeedbackToggle) {
            console.error('Voice feedback toggle not found!');
        }
        if (!autoResponseToggle) {
            console.error('Auto response toggle not found!');
        }
        
        voiceControlBtn.addEventListener('click', () => {
            console.log('Voice control button clicked. Current command mode:', commandMode);
            if (commandMode) {
                stopCommandMode();
            } else {
                startCommandMode();
            }
        });
        
        wakeWordBtn.addEventListener('click', () => {
            const newWakeWord = prompt('Enter new wake word (default: "jarvis"):', wakeWord);
            if (newWakeWord && newWakeWord.trim()) {
                wakeWord = newWakeWord.toLowerCase().trim();
                speakResponse(`Wake word changed to "${wakeWord}"`);
            }
        });
        
        voiceCommandsList.addEventListener('click', () => {
            voiceCommandsList.style.display = voiceCommandsList.style.display === 'none' ? 'block' : 'none';
        });
        
        voiceFeedbackToggle.addEventListener('change', (e) => {
            voiceFeedback = e.target.checked;
        });
        
        autoResponseToggle.addEventListener('change', (e) => {
            autoResponse = e.target.checked;
        });
        
        // Test Jarvis button
        const testJarvisBtn = document.getElementById('testJarvisBtn');
        if (testJarvisBtn) {
            testJarvisBtn.addEventListener('click', testJarvis);
        } else {
            console.error('Test Jarvis button not found!');
        }

        textInput.addEventListener('input', () => {
            processTextBtn.disabled = !textInput.value.trim();
        });

        textInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey && textInput.value.trim()) {
                e.preventDefault();
                processText();
            }
        });

        // History item click
        historyList.addEventListener('click', (e) => {
            const historyItem = e.target.closest('.history-item');
            if (historyItem) {
                const text = historyItem.dataset.text;
                textInput.value = text;
                processText();
            }
        });

        // Category filter buttons (placeholder functionality)
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
            });
        });

        // Initialize
        processTextBtn.disabled = true;
        
        // Initialize AI Training features
        updateTrainingStats();
        updateLastUpdated();
        
        // Set default sign language category as active
        document.querySelector('.sign-category[data-category="asl"]').style.borderColor = '#667eea';
        document.querySelector('.sign-category[data-category="asl"]').style.backgroundColor = '#f8f9fa';
        
        // Initialize voice commands
        initializeVoiceCommands();
       
        // Initialize speech recognition on page load
        if (initializeSpeechRecognition()) {
            console.log('Speech recognition initialized successfully');
        } else {
            console.log('Speech recognition not available');
            recordBtn.textContent = '🎤 Not Supported';
            recordBtn.disabled = true;
        }
        
        // Initialize text-to-speech
        if (speechSynthesis) {
            // Load voices when they become available
            if (speechSynthesis.getVoices().length > 0) {
                loadVoices();
            } else {
                speechSynthesis.onvoiceschanged = loadVoices;
            }
            console.log('Text-to-speech initialized successfully');
        } else {
            console.log('Text-to-speech not supported');
            speakBtn.textContent = '🔊 Not Supported';
            speakBtn.disabled = true;
        }

        // Initialize ASL features
        console.log('Advanced ASL features loaded:', Object.keys(advancedASLDatabase).length, 'signs available');
        
        // Welcome message with ASL features
        setTimeout(() => {
            speakResponse('Welcome to the Advanced ASL Gesture Detection System. I can help you learn American Sign Language with finger spelling, practice mode, and interactive quizzes.');
            showStatus('Advanced ASL system ready! Try finger spelling or practice mode.', 'success');
        }, 1000);
       
        console.log('Gesture Detection Dashboard Loaded!');
        
        // Test Jarvis functionality
        function testJarvis() {
            console.log('Testing Jarvis functionality...');
            console.log('Command mode:', commandMode);
            console.log('Wake word:', wakeWord);
            console.log('Voice feedback:', voiceFeedback);
            console.log('Available commands:', Array.from(voiceCommands.keys()));
            
            // Test voice response
            speakResponse('Jarvis is online and ready for commands');
        }
        
        // Auto-test after 2 seconds
        setTimeout(testJarvis, 2000);
    </script>
</body>
</html>